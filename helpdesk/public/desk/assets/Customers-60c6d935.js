import{d as k,m as z,n as A,p as F,W as L,Q as _,k as x,g as l,w as v,h as n,r as b,e as g,l as r,a$ as U,z as R,H,c as $,b0 as P,f as N,t as q,y as I,A as y,I as T,S as O}from"./index-62a62e6e.js";import{L as Q}from"./knowledgeBase-e21cae7f.js";import{_ as W}from"./ListViewBuilder.vue_vue_type_script_setup_true_lang-678127e3.js";import{_ as E}from"./Avatar.vue_vue_type_script_setup_true_lang-d4d1e36b.js";import{u as j}from"./pageMeta-71b2b81d.js";import{F as G}from"./FileUploader-08f99e92.js";import"./Dropdown.vue_vue_type_script_setup_true_lang-8f31c9b1.js";import"./NestedPopover-3f769b77.js";import"./DateRangePicker.vue_vue_type_script_setup_true_lang-4c092d39.js";import"./more-horizontal-44c34a82.js";import"./dayjs-23c9994e.js";import"./StarRating.vue_vue_type_script_setup_true_lang-af2bc1e1.js";import"./FadedScrollableDiv.vue_vue_type_script_setup_true_lang-009f88f9.js";import"./Link-2b0a1c2c.js";import"./globalStore-353b4b5d.js";import"./EmptyState.vue_vue_type_script_setup_true_lang-93e50375.js";const J={class:"space-y-4"},K={class:"space-y-1"},X={class:"space-y-1"},Y={class:"float-right flex space-x-2"},Z=k({__name:"NewCustomerDialog",props:{modelValue:{type:Boolean},modelModifiers:{}},emits:z(["customerCreated"],["update:modelValue"]),setup(C,{emit:m}){const u=m,i=A(C,"modelValue"),o=F({customer:"",domain:""}),s=L({url:"frappe.client.insert",method:"POST",data:{doc:{doctype:"HD Customer",customer_name:o.customer,domain:o.domain}},onSuccess:()=>{o.customer="",o.domain="",_.success("Customer created"),u("customerCreated")},onError:c=>{_.error(c.messages[0])}});function p(){if(!o.customer){_.error("Customer name is required");return}s.submit({doc:{doctype:"HD Customer",customer_name:o.customer,domain:o.domain}})}return(c,t)=>{const e=b("Button");return g(),x("div",null,[l(n(H),{modelValue:i.value,"onUpdate:modelValue":t[2]||(t[2]=a=>i.value=a),options:{title:"Add New Customer",size:"sm"}},{"body-content":v(()=>[r("div",J,[r("div",K,[l(n(U),{modelValue:o.customer,"onUpdate:modelValue":t[0]||(t[0]=a=>o.customer=a),label:"Customer Name",type:"text",placeholder:"Tesla Inc."},null,8,["modelValue"])]),r("div",X,[l(n(U),{modelValue:o.domain,"onUpdate:modelValue":t[1]||(t[1]=a=>o.domain=a),label:"Domain",type:"text",placeholder:"eg: tesla.com, mycompany.com"},null,8,["modelValue"])]),r("div",Y,[l(e,{label:"Add",theme:"gray",variant:"solid",onClick:R(p,["prevent"])})])])]),_:1},8,["modelValue"])])}}}),ee={class:"flex flex-col items-center gap-4 p-6"},oe={class:"text-xl font-medium text-gray-900"},te={class:"flex gap-2"},se=k({__name:"CustomerDialog",props:{name:{type:String,required:!0}},emits:["customer-updated"],setup(C,{emit:m}){const u=C,i=m,o=$({get(){var e;return(e=s.doc)==null?void 0:e.domain},set(e){s.doc.domain=e}}),s=P({doctype:"HD Customer",name:u.name,auto:!0,setValue:{onSuccess(){_.success("Customer updated")},onError(){_.error("Error updating customer")}}}),p=$(()=>{var e;return{title:(e=s.doc)==null?void 0:e.name,actions:[{label:"Save",theme:"gray",variant:"solid",onClick:()=>c()}]}});async function c(){await s.setValue.submit({domain:o.value}),i("customer-updated")}function t(e){s.setValue.submit({image:(e==null?void 0:e.file_url)||null}),i("customer-updated")}return(e,a)=>{const V=b("Button"),d=b("Input");return g(),N(n(H),{options:p.value},{"body-main":v(()=>{var h,w,B,D;return[r("div",ee,[r("div",oe,q((h=n(s).doc)==null?void 0:h.name),1),l(n(E),{size:"lg",label:(w=n(s).doc)==null?void 0:w.name,image:(B=n(s).doc)==null?void 0:B.image,class:"cursor-pointer hover:opacity-80"},null,8,["label","image"]),r("div",te,[l(n(G),{onSuccess:a[0]||(a[0]=f=>t(f))},{default:v(({uploading:f,openFileSelector:M})=>{var S;return[l(V,{label:(S=n(s).doc)!=null&&S.image?"Change photo":"Upload photo",loading:f,onClick:M},null,8,["label","loading","onClick"])]}),_:1}),(D=n(s).doc)!=null&&D.image?(g(),N(V,{key:0,label:"Remove photo",onClick:a[1]||(a[1]=f=>t(null))})):I("",!0)]),r("form",{class:"w-full",onSubmit:R(c,["prevent"])},[l(d,{modelValue:o.value,"onUpdate:modelValue":a[2]||(a[2]=f=>o.value=f),label:"Domain",placeholder:"example.com"},null,8,["modelValue"])],32)])]}),_:1},8,["options"])}}}),ae={class:"flex flex-col"},le={key:0},xe=k({__name:"Customers",setup(C){const m=y(!1),u=y(!1),i=y(null),o=y(null);function s(t){i.value=t,u.value=!0}function p(t=!1){var e;t?u.value=!1:m.value=!1,(e=o.value)==null||e.reload()}const c=$(()=>({doctype:"HD Customer",selectable:!0,showSelectBanner:!0,columnConfig:{name:{prefix:({row:t})=>T(E,{shape:"circle",image:t.image,label:t.name,size:"sm"})}},emptyState:{title:"No Customers Found"}}));return j(()=>({title:"Customers"})),(t,e)=>{const a=O,V=b("Button");return g(),x("div",ae,[l(Q,null,{"left-header":v(()=>[...e[5]||(e[5]=[r("div",{class:"text-lg font-medium text-gray-900"},"Customers",-1)])]),"right-header":v(()=>[l(V,{label:"New customer",theme:"gray",variant:"solid",onClick:e[0]||(e[0]=d=>m.value=!m.value)},{prefix:v(()=>[l(a,{class:"h-4 w-4"})]),_:1})]),_:1}),l(W,{ref_key:"listViewRef",ref:o,options:c.value,onRowClick:s,onEmptyStateAction:e[1]||(e[1]=d=>m.value=!0)},null,8,["options"]),l(Z,{modelValue:m.value,"onUpdate:modelValue":e[2]||(e[2]=d=>m.value=d),onCustomerCreated:p},null,8,["modelValue"]),u.value?(g(),x("span",le,[l(se,{modelValue:u.value,"onUpdate:modelValue":e[3]||(e[3]=d=>u.value=d),name:i.value,onCustomerUpdated:e[4]||(e[4]=d=>p(!0))},null,8,["modelValue","name"])])):I("",!0)])}}});export{xe as default};
//# sourceMappingURL=Customers-60c6d935.js.map
