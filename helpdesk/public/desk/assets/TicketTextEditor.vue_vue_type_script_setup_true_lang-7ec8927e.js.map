{"version":3,"file":"TicketTextEditor.vue_vue_type_script_setup_true_lang-7ec8927e.js","sources":["../../../../desk/src/components/TextEditor.vue","../../../../desk/src/pages/ticket/TicketTextEditor.vue"],"sourcesContent":["<template>\n  <div class=\"rounded p-3 shadow w-full\">\n    <FTextEditor\n      ref=\"e\"\n      :extensions=\"[PreserveVideoControls]\"\n      v-bind=\"$attrs\"\n      :editor-class=\"[\n        'prose-f max-h-64 max-w-none  overflow-auto my-4 min-h-[5rem]',\n        getFontFamily(modelValue),\n      ]\"\n      bubble-menu\n      :content=\"modelValue\"\n      @change=\"$emit('update:modelValue', $event)\"\n    >\n      <template #top>\n        <span class=\"text-base\">\n          <span class=\"flex items-center justify-between\">\n            <UserAvatar\n              :name=\"authStore.userName\"\n              :image=\"authStore.userImage\"\n              expand\n              strong\n            />\n            <slot name=\"top-right\" />\n          </span>\n          <slot name=\"top-bottom\" />\n        </span>\n      </template>\n      <template #bottom>\n        <div class=\"flex flex-col gap-2\">\n          <slot name=\"bottom-top\" />\n          <div\n            class=\"flex flex-col space-y-1.5 overflow-auto sm:flex-row sm:justify-between\"\n          >\n            <div class=\"flex items-center gap-1\">\n              <TextEditorFixedMenu :buttons=\"fixedMenu\" />\n              <slot name=\"bottom-left\" />\n            </div>\n            <div class=\"flex items-center gap-2\">\n              <Button\n                label=\"Discard\"\n                theme=\"gray\"\n                variant=\"subtle\"\n                @click=\"\n                  () => {\n                    editor.commands.clearContent(true);\n                    $emit('clear');\n                  }\n                \"\n              />\n              <slot name=\"bottom-right\" />\n            </div>\n          </div>\n        </div>\n      </template>\n    </FTextEditor>\n  </div>\n</template>\n<script setup lang=\"ts\">\nimport { UserAvatar } from \"@/components\";\nimport { useAuthStore } from \"@/stores/auth\";\nimport { PreserveVideoControls } from \"@/tiptap-extensions\";\nimport { getFontFamily } from \"@/utils\";\nimport { TextEditor as FTextEditor, TextEditorFixedMenu } from \"frappe-ui\";\nimport { computed, nextTick, ref } from \"vue\";\n\ninterface P {\n  modelValue: string;\n  autofocus?: boolean;\n}\n\ninterface E {\n  (event: \"clear\"): void;\n  (event: \"update:modelValue\", any): string;\n}\n\nconst props = withDefaults(defineProps<P>(), {\n  autofocus: false,\n});\n\ndefineEmits<E>();\n\nconst e = ref(null);\nconst editor = computed(() => e.value.editor);\nconst authStore = useAuthStore();\nconst fixedMenu = [\n  \"Paragraph\",\n  [\"Heading 2\", \"Heading 3\", \"Heading 4\", \"Heading 5\"],\n  \"Bullet List\",\n  \"Numbered List\",\n  \"Image\",\n  \"Video\",\n  \"Link\",\n  \"Blockquote\",\n  \"Code\",\n];\n\ndefineExpose({\n  editor,\n});\n\nif (props.autofocus) {\n  nextTick(() => e.value.editor.commands.focus());\n}\n</script>\n","<template>\n  <HTextEditor\n    v-if=\"expand\"\n    ref=\"e\"\n    :model-value=\"content\"\n    :placeholder=\"placeholder\"\n    @update:model-value=\"$emit('update:content', $event)\"\n    @clear=\"() => $emit('update:attachments', [])\"\n  >\n    <template #bottom-top>\n      <div class=\"flex flex-wrap gap-2\">\n        <AttachmentItem\n          v-for=\"a in attachments\"\n          :key=\"a.file_url\"\n          :label=\"a.file_name\"\n          :url=\"!['MOV', 'MP4'].includes(a.file_type) ? a.file_url : null\"\n        >\n          <template #suffix>\n            <Icon\n              icon=\"lucide:x\"\n              @click.stop=\"\n                () => {\n                  $emit(\n                    'update:attachments',\n                    attachments.filter((b) => b.file_url !== a.file_url)\n                  );\n                  removeAttachmentFromServer(a.name);\n                }\n              \"\n            />\n          </template>\n        </AttachmentItem>\n      </div>\n    </template>\n    <template #bottom-left>\n      <span class=\"flex\">\n        <slot name=\"bottom-left\" />\n        <FileUploader\n          :upload-args=\"{\n            folder: 'Home/Helpdesk',\n            private: true,\n          }\"\n          @success=\"(f: File) => $emit('update:attachments', [...attachments, f])\"\n          @failure=\"() => toast.error('Error uploading file')\"\n        >\n          <template #default=\"{ openFileSelector }\">\n            <Button theme=\"gray\" variant=\"ghost\" @click=\"openFileSelector()\">\n              <template #icon>\n                <Icon icon=\"lucide:paperclip\" />\n              </template>\n            </Button>\n          </template>\n        </FileUploader>\n      </span>\n    </template>\n    <template #top-right>\n      <slot name=\"top-right\" />\n    </template>\n    <template #top-bottom>\n      <slot name=\"top-bottom\" />\n    </template>\n    <template #bottom-right>\n      <slot name=\"bottom-right\" />\n    </template>\n  </HTextEditor>\n  <div\n    v-else\n    class=\"flex w-full cursor-pointer items-center gap-2 rounded bg-gray-100 px-3.5 py-2 hover:bg-gray-200\"\n    @click=\"() => $emit('update:expand', !expand)\"\n  >\n    <UserAvatar\n      :name=\"authStore.userName\"\n      :image=\"authStore.userImage\"\n      size=\"sm\"\n    />\n    <span class=\"text-base text-gray-700\">\n      {{ placeholder }}\n    </span>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport {\n  AttachmentItem,\n  TextEditor as HTextEditor,\n  UserAvatar,\n} from \"@/components\";\nimport { useAuthStore } from \"@/stores/auth\";\nimport { File } from \"@/types\";\nimport { removeAttachmentFromServer } from \"@/utils\";\nimport { Icon } from \"@iconify/vue\";\nimport { FileUploader, toast } from \"frappe-ui\";\nimport { computed, ref } from \"vue\";\n\ninterface P {\n  content: string;\n  placeholder: string;\n  attachments: File[];\n  expand?: boolean;\n}\n\ninterface E {\n  (event: \"update:content\", content: string): void;\n  (event: \"update:attachments\", attachments: File[]): void;\n  (event: \"update:expand\", expand: boolean): void;\n}\n\nwithDefaults(defineProps<P>(), {\n  expand: false,\n});\ndefineEmits<E>();\nconst e = ref(null);\nconst editor = computed(() => e.value.editor);\nconst authStore = useAuthStore();\ndefineExpose({\n  editor,\n});\n</script>\n"],"names":["props","__props","e","ref","editor","computed","authStore","useAuthStore","fixedMenu","__expose","nextTick","_openBlock","_createElementBlock","_hoisted_1","_createVNode","_unref","_mergeProps","PreserveVideoControls","$attrs","getFontFamily","modelValue","_cache","$event","$emit","_createElementVNode","_hoisted_2","_hoisted_3","UserAvatar","_renderSlot","_ctx","_hoisted_4","_hoisted_5","_hoisted_6","TextEditorFixedMenu","_hoisted_7","_component_Button","expand","_createBlock","HTextEditor","content","placeholder","_Fragment","_renderList","attachments","a","AttachmentItem","Icon","_withModifiers","b","removeAttachmentFromServer","FileUploader","f","toast","_withCtx","openFileSelector","_toDisplayString"],"mappings":"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"}