import{d as P,A as I,I as W,a6 as ht,a7 as tt,c as T,a8 as ge,Z as Re,M as ae,a3 as re,a9 as Ct,aa as z,ab as Ce,ac as kt,F as q,ad as lt,X as Pe,ae as ce,af as wt,ag as Je,ah as Ie,ai as X,aj as Se,ak as $t,al as St,am as me,an as ee,ao as ve,e as o,f as V,w as h,k as C,G as K,h as e,C as be,a1 as ke,l as f,x as H,v as qe,y as j,s as xe,t as L,m as Z,n as ne,g as x,D as Ye,E as Qe,a2 as Ue,j as oe,ap as at,a as Le,aq as ye,W as se,r as A,ar as Me,z as Y,as as Ne,at as ze,au as nt,Q as pe,av as st,aw as It,ax as Tt,ay as fe,P as Vt,az as Bt,aA as De,aB as Lt,aC as Et,aD as Ft,aE as Oe,aF as At,b as ot,H as it,aG as _e,aH as ue,aI as de,V as He,aJ as Mt,N as jt,aK as Rt,Y as Dt,L as he,aL as Ot,aM as ie,aN as Xe,J as Pt,$ as et,aO as qt}from"./index-62a62e6e.js";import{a as Ke,P as rt,b as te,d as le,T as Ut,L as ut}from"./more-horizontal-44c34a82.js";import{d as U}from"./dayjs-23c9994e.js";import{u as Nt}from"./knowledgeBase-e21cae7f.js";import{_ as Ee}from"./AttachmentItem.vue_vue_type_script_setup_true_lang-cb2930a7.js";import{F as dt}from"./FileUploader-08f99e92.js";import{T as ct,_ as Fe}from"./TextEditor.vue_vue_type_script_setup_true_lang-3540b034.js";import{_ as we}from"./TicketFeedback.vue_vue_type_script_setup_true_lang-f4b785e0.js";import{_ as Te}from"./UserAvatar.vue_vue_type_script_setup_true_lang-3c21d3f7.js";import{_ as Ve}from"./Autocomplete-b8bbe20a.js";import{a as zt,_ as Ht}from"./Link-2b0a1c2c.js";import{_ as Ze}from"./Avatar.vue_vue_type_script_setup_true_lang-d4d1e36b.js";import{_ as Ge}from"./Dropdown.vue_vue_type_script_setup_true_lang-8f31c9b1.js";import{_ as Kt}from"./EmailContent-07157247.js";import{a as Zt}from"./FadedScrollableDiv.vue_vue_type_script_setup_true_lang-009f88f9.js";let Gt=P({props:{onFocus:{type:Function,required:!0}},setup(t){let n=I(!0);return()=>n.value?W(tt,{as:"button",type:"button",features:ht.Focusable,onFocus(c){c.preventDefault();let a,s=50;function m(){var r;if(s--<=0){a&&cancelAnimationFrame(a);return}if((r=t.onFocus)!=null&&r.call(t)){n.value=!1,cancelAnimationFrame(a);return}a=requestAnimationFrame(m)}a=requestAnimationFrame(m)}}):null}});var Wt=(t=>(t[t.Forwards=0]="Forwards",t[t.Backwards=1]="Backwards",t))(Wt||{}),Jt=(t=>(t[t.Less=-1]="Less",t[t.Equal=0]="Equal",t[t.Greater=1]="Greater",t))(Jt||{});let mt=Symbol("TabsContext");function $e(t){let n=ce(mt,null);if(n===null){let c=new Error(`<${t} /> is missing a parent <TabGroup /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(c,$e),c}return n}let We=Symbol("TabsSSRContext"),Yt=P({name:"TabGroup",emits:{change:t=>!0},props:{as:{type:[Object,String],default:"template"},selectedIndex:{type:[Number],default:null},defaultIndex:{type:[Number],default:0},vertical:{type:[Boolean],default:!1},manual:{type:[Boolean],default:!1}},inheritAttrs:!1,setup(t,{slots:n,attrs:c,emit:a}){var s;let m=I((s=t.selectedIndex)!=null?s:t.defaultIndex),r=I([]),u=I([]),g=T(()=>t.selectedIndex!==null),d=T(()=>g.value?t.selectedIndex:m.value);function v(p){var b;let k=ge(i.tabs.value,z),l=ge(i.panels.value,z),y=k.filter(_=>{var F;return!((F=z(_))!=null&&F.hasAttribute("disabled"))});if(p<0||p>k.length-1){let _=Ie(m.value===null?0:Math.sign(p-m.value),{[-1]:()=>1,0:()=>Ie(Math.sign(p),{[-1]:()=>0,0:()=>0,1:()=>1}),1:()=>0}),F=Ie(_,{0:()=>k.indexOf(y[0]),1:()=>k.indexOf(y[y.length-1])});F!==-1&&(m.value=F),i.tabs.value=k,i.panels.value=l}else{let _=k.slice(0,p),F=[...k.slice(p),..._].find(S=>y.includes(S));if(!F)return;let D=(b=k.indexOf(F))!=null?b:i.selectedIndex.value;D===-1&&(D=i.selectedIndex.value),m.value=D,i.tabs.value=k,i.panels.value=l}}let i={selectedIndex:T(()=>{var p,b;return(b=(p=m.value)!=null?p:t.defaultIndex)!=null?b:null}),orientation:T(()=>t.vertical?"vertical":"horizontal"),activation:T(()=>t.manual?"manual":"auto"),tabs:r,panels:u,setSelectedIndex(p){d.value!==p&&a("change",p),g.value||v(p)},registerTab(p){var b;if(r.value.includes(p))return;let k=r.value[m.value];if(r.value.push(p),r.value=ge(r.value,z),!g.value){let l=(b=r.value.indexOf(k))!=null?b:m.value;l!==-1&&(m.value=l)}},unregisterTab(p){let b=r.value.indexOf(p);b!==-1&&r.value.splice(b,1)},registerPanel(p){u.value.includes(p)||(u.value.push(p),u.value=ge(u.value,z))},unregisterPanel(p){let b=u.value.indexOf(p);b!==-1&&u.value.splice(b,1)}};Re(mt,i);let w=I({tabs:[],panels:[]}),B=I(!1);ae(()=>{B.value=!0}),Re(We,T(()=>B.value?null:w.value));let $=T(()=>t.selectedIndex);return ae(()=>{re([$],()=>{var p;return v((p=t.selectedIndex)!=null?p:t.defaultIndex)},{immediate:!0})}),Ct(()=>{if(!g.value||d.value==null||i.tabs.value.length<=0)return;let p=ge(i.tabs.value,z);p.some((b,k)=>z(i.tabs.value[k])!==z(b))&&i.setSelectedIndex(p.findIndex(b=>z(b)===z(i.tabs.value[d.value])))}),()=>{let p={selectedIndex:m.value};return W(q,[r.value.length<=0&&W(Gt,{onFocus:()=>{for(let b of r.value){let k=z(b);if((k==null?void 0:k.tabIndex)===0)return k.focus(),!0}return!1}}),Ce({theirProps:{...c,...kt(t,["selectedIndex","defaultIndex","manual","vertical","onChange"])},ourProps:{},slot:p,slots:n,attrs:c,name:"TabGroup"})])}}}),Qt=P({name:"TabList",props:{as:{type:[Object,String],default:"div"}},setup(t,{attrs:n,slots:c}){let a=$e("TabList");return()=>{let s={selectedIndex:a.selectedIndex.value},m={role:"tablist","aria-orientation":a.orientation.value};return Ce({ourProps:m,theirProps:t,slot:s,attrs:n,slots:c,name:"TabList"})}}}),Xt=P({name:"Tab",props:{as:{type:[Object,String],default:"button"},disabled:{type:[Boolean],default:!1},id:{type:String,default:null}},setup(t,{attrs:n,slots:c,expose:a}){var s;let m=(s=t.id)!=null?s:`headlessui-tabs-tab-${lt()}`,r=$e("Tab"),u=I(null);a({el:u,$el:u}),ae(()=>r.registerTab(u)),Pe(()=>r.unregisterTab(u));let g=ce(We),d=T(()=>{if(g.value){let l=g.value.tabs.indexOf(m);return l===-1?g.value.tabs.push(m)-1:l}return-1}),v=T(()=>{let l=r.tabs.value.indexOf(u);return l===-1?d.value:l}),i=T(()=>v.value===r.selectedIndex.value);function w(l){var y;let _=l();if(_===Se.Success&&r.activation.value==="auto"){let F=(y=St(u))==null?void 0:y.activeElement,D=r.tabs.value.findIndex(S=>z(S)===F);D!==-1&&r.setSelectedIndex(D)}return _}function B(l){let y=r.tabs.value.map(_=>z(_)).filter(Boolean);if(l.key===X.Space||l.key===X.Enter){l.preventDefault(),l.stopPropagation(),r.setSelectedIndex(v.value);return}switch(l.key){case X.Home:case X.PageUp:return l.preventDefault(),l.stopPropagation(),w(()=>me(y,ee.First));case X.End:case X.PageDown:return l.preventDefault(),l.stopPropagation(),w(()=>me(y,ee.Last))}if(w(()=>Ie(r.orientation.value,{vertical(){return l.key===X.ArrowUp?me(y,ee.Previous|ee.WrapAround):l.key===X.ArrowDown?me(y,ee.Next|ee.WrapAround):Se.Error},horizontal(){return l.key===X.ArrowLeft?me(y,ee.Previous|ee.WrapAround):l.key===X.ArrowRight?me(y,ee.Next|ee.WrapAround):Se.Error}}))===Se.Success)return l.preventDefault()}let $=I(!1);function p(){var l;$.value||($.value=!0,!t.disabled&&((l=z(u))==null||l.focus({preventScroll:!0}),r.setSelectedIndex(v.value),$t(()=>{$.value=!1})))}function b(l){l.preventDefault()}let k=wt(T(()=>({as:t.as,type:n.type})),u);return()=>{var l,y;let _={selected:i.value,disabled:(l=t.disabled)!=null?l:!1},{...F}=t,D={ref:u,onKeydown:B,onMousedown:b,onClick:p,id:m,role:"tab",type:k.value,"aria-controls":(y=z(r.panels.value[v.value]))==null?void 0:y.id,"aria-selected":i.value,tabIndex:i.value?0:-1,disabled:t.disabled?!0:void 0};return Ce({ourProps:D,theirProps:F,slot:_,attrs:n,slots:c,name:"Tab"})}}}),el=P({name:"TabPanels",props:{as:{type:[Object,String],default:"div"}},setup(t,{slots:n,attrs:c}){let a=$e("TabPanels");return()=>{let s={selectedIndex:a.selectedIndex.value};return Ce({theirProps:t,ourProps:{},slot:s,attrs:c,slots:n,name:"TabPanels"})}}}),tl=P({name:"TabPanel",props:{as:{type:[Object,String],default:"div"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},id:{type:String,default:null},tabIndex:{type:Number,default:0}},setup(t,{attrs:n,slots:c,expose:a}){var s;let m=(s=t.id)!=null?s:`headlessui-tabs-panel-${lt()}`,r=$e("TabPanel"),u=I(null);a({el:u,$el:u}),ae(()=>r.registerPanel(u)),Pe(()=>r.unregisterPanel(u));let g=ce(We),d=T(()=>{if(g.value){let w=g.value.panels.indexOf(m);return w===-1?g.value.panels.push(m)-1:w}return-1}),v=T(()=>{let w=r.panels.value.indexOf(u);return w===-1?d.value:w}),i=T(()=>v.value===r.selectedIndex.value);return()=>{var w;let B={selected:i.value},{tabIndex:$,...p}=t,b={ref:u,id:m,role:"tabpanel","aria-labelledby":(w=z(r.tabs.value[v.value]))==null?void 0:w.id,tabIndex:i.value?$:-1};return!i.value&&t.unmount&&!t.static?W(tt,{as:"span","aria-hidden":!0,...b}):Ce({ourProps:b,theirProps:p,slot:B,attrs:n,slots:c,features:Je.Static|Je.RenderStrategy,visible:i.value,name:"TabPanel"})}}});const ll={__name:"TabList",setup(t){const n=ce("tab"),c=I([]),a=I(null),s=T(()=>{var u;return(u=n.value.tabs.value)==null?void 0:u.length}),m=I("");function r(u){u>=s.value&&(u=s.value-1);const g=c.value[u].el;n.value.vertical.value?(a.value.style.height=`${g.offsetHeight}px`,a.value.style.top=`${g.offsetTop}px`):(a.value.style.width=`${g.offsetWidth}px`,a.value.style.left=`${g.offsetLeft}px`)}return re(()=>n.value.tabIndex.value,u=>{u>=s.value&&(n.value.tabIndex.value=s.value-1),m.value="transition-all duration-300 ease-in-out",ve(()=>r(u))}),ae(()=>{ve(()=>r(n.value.tabIndex.value)),setTimeout(()=>r(n.value.tabIndex.value),100)}),(u,g)=>(o(),V(e(Qt),{class:H(["relative flex",e(n).vertical?"flex-col border-r overflow-y-auto":"gap-7.5 border-b overflow-x-auto items-center px-5"])},{default:h(()=>[(o(!0),C(q,null,K(e(n).tabs,(d,v)=>(o(),V(e(Xt),{ref_for:!0,ref_key:"tabRef",ref:c,as:"template",key:v,class:"focus:outline-none focus:transition-none"},{default:h(({selected:i})=>[be(u.$slots,"default",ke({ref_for:!0},{tab:d,selected:i}),()=>[f("button",{class:H(["flex items-center gap-1.5 text-base text-ink-gray-5 duration-300 ease-in-out hover:text-ink-gray-9",[i?"text-ink-gray-9":"",e(n).vertical?"py-2.5 px-4 border-r border-transparent hover:border-outline-gray-3":"py-3 border-b border-transparent hover:border-outline-gray-3"]])},[d.icon?(o(),V(qe(d.icon),{key:0,class:"size-4"})):j("",!0),xe(" "+L(d.label),1)],2)])]),_:2},1024))),128)),f("div",{ref_key:"indicator",ref:a,class:H(["tab-indicator absolute bg-surface-gray-7",[e(n).vertical?"right-0 w-px":"bottom-0 h-px",m.value]])},null,2)]),_:3},8,["class"]))}},al={__name:"TabPanel",setup(t){const n=ce("tab");return(c,a)=>(o(),V(e(el),{class:"flex flex-1 overflow-hidden"},{default:h(()=>[(o(!0),C(q,null,K(e(n).tabs,(s,m)=>(o(),V(e(tl),{class:"flex flex-1 flex-col overflow-y-auto focus:outline-none",key:m},{default:h(()=>[be(c.$slots,"default",ke({ref_for:!0},{tab:s}))]),_:2},1024))),128))]),_:3}))}},Mn={__name:"Tabs",props:Z({as:{type:String,default:"template"},tabs:{type:Array,required:!0},vertical:{type:Boolean,default:!1}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(t){const n=t,c=ne(t,"modelValue");return Re("tab",T(()=>({tabIndex:c,tabs:n.tabs,vertical:n.vertical}))),(a,s)=>(o(),V(e(Yt),ke(t.as!=="template"?{as:t.as,class:["flex flex-1 overflow-hidden",t.vertical?"":"flex-col "]}:{},{defaultIndex:c.value,selectedIndex:c.value,onChange:s[0]||(s[0]=m=>c.value=m)}),{default:h(()=>[be(a.$slots,"default",{},()=>[x(ll,null,{default:h(({tab:m,selected:r})=>[be(a.$slots,"tab-item",Ye(Qe({tab:m,selected:r})))]),_:3}),x(al,null,{default:h(({tab:m})=>[be(a.$slots,"tab-panel",Ye(Qe({tab:m})))]),_:3})])]),_:3},16,["defaultIndex","selectedIndex"]))}},nl=P({__name:"SearchComplete",props:{value:{type:String,required:!1,default:""},doctype:{type:String,required:!0},searchField:{type:String,required:!1,default:"name"},labelField:{type:String,required:!1,default:"name"},valueField:{type:String,required:!1,default:"name"},pageLength:{type:Number,required:!1,default:100},resetInput:{type:Boolean,required:!1,default:!1},customFilters:{type:Object,required:!1,default:{}}},emits:["change"],setup(t,{emit:n}){const c=n,a=t,s=Ue({doctype:a.doctype,pageLength:a.pageLength,auto:!0,fields:[a.labelField,a.searchField,a.valueField],filters:{[a.searchField]:["like",`%${a.value}%`],...a.customFilters},onSuccess:()=>{r.value=a.value?m.value.find(g=>g.value===a.value):null}}),m=T(()=>{var g;return((g=s.data)==null?void 0:g.map(d=>({label:d[a.labelField],value:d[a.valueField]})))||[]}),r=I(null);function u(g){s.update({filters:{[a.searchField]:["like",`%${g}%`],...a.customFilters}}),s.reload()}return(g,d)=>(o(),V(e(Ve),{placeholder:"Select an option",options:m.value,value:r.value,"onUpdate:query":d[0]||(d[0]=v=>u(v)),onChange:d[1]||(d[1]=v=>{t.resetInput||(r.value=v),c("change",v)})},null,8,["options","value"]))}}),sl={},ol={width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function il(t,n){return o(),C("svg",ol,[...n[0]||(n[0]=[f("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M6.29021 2.64272C6.68375 0.785763 9.33429 0.785757 9.72783 2.64272L10.3657 5.65238L13.3753 6.29021C15.2323 6.68375 15.2323 9.33429 13.3753 9.72783L10.3657 10.3657L9.72783 13.3753C9.33429 15.2323 6.68375 15.2323 6.29021 13.3753L5.65238 10.3657L2.64272 9.72783C0.785763 9.33429 0.785757 6.68375 2.64272 6.29021L5.65238 5.65238L6.29021 2.64272ZM8.74956 2.85004C8.58 2.04999 7.43804 2.04998 7.26848 2.85004L6.56324 6.17777L6.49584 6.49583L6.17777 6.56324L2.85004 7.26848C2.04999 7.43804 2.04998 8.58 2.85004 8.74956L6.17777 9.4548L6.49584 9.5222L6.56324 9.84027L7.26848 13.168C7.43804 13.9681 8.58 13.9681 8.74956 13.168L9.4548 9.84027L9.5222 9.5222L9.84027 9.4548L13.168 8.74956C13.9681 8.58 13.9681 7.43804 13.168 7.26848L9.84027 6.56324L9.5222 6.49583L9.4548 6.17777L8.74956 2.85004Z",fill:"currentColor"},null,-1)])])}const rl=oe(sl,[["render",il]]),ul={},dl={width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function cl(t,n){return o(),C("svg",dl,[...n[0]||(n[0]=[f("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M12.5684 2.50774C11.5403 1.49742 9.95026 1.49742 8.92215 2.50774L3.62404 7.71417C2.12532 9.18695 2.12532 11.669 3.62404 13.1418C5.12762 14.6194 7.66861 14.6194 9.17219 13.1418L12.1609 10.2049C12.3578 10.0113 12.6744 10.0141 12.8679 10.211C13.0615 10.408 13.0587 10.7246 12.8618 10.9181L9.8731 13.8551C7.98045 15.715 4.81578 15.715 2.92313 13.8551C1.02562 11.9904 1.02562 8.86558 2.92313 7.00091L8.22124 1.79449C9.63842 0.401838 11.8521 0.401838 13.2693 1.79449C14.6914 3.19191 14.6914 5.38225 13.2693 6.77968L13.2668 6.78213L13.2668 6.78212L8.37876 11.5189C8.37834 11.5193 8.37793 11.5197 8.37752 11.5201C7.51767 12.3638 6.11144 12.3939 5.29119 11.5097C4.43611 10.6596 4.40778 9.26893 5.30922 8.46081L7.33823 6.46692C7.53518 6.27337 7.85175 6.27613 8.04531 6.47309C8.23886 6.67005 8.23609 6.98662 8.03913 7.18017L6.0014 9.18264L5.99203 9.19185L5.98219 9.20055C5.5391 9.59243 5.5104 10.3231 6.0014 10.8056L6.01078 10.8148L6.01967 10.8245C6.42299 11.2649 7.18224 11.2926 7.67785 10.8056L7.68034 10.8032L7.68035 10.8032L12.5684 6.06643C12.5688 6.06604 12.5692 6.06565 12.5696 6.06526C13.5917 5.05969 13.5913 3.51289 12.5684 2.50774Z",fill:"currentColor"},null,-1)])])}const ft=oe(ul,[["render",cl]]),ml={},fl={width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function pl(t,n){return o(),C("svg",fl,[...n[0]||(n[0]=[f("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M8 2.5C4.2911 2.5 1.5 4.84419 1.5 7.5C1.5 9.14452 2.54729 10.6518 4.25112 11.5816C4.50048 11.7177 4.758 12.0041 4.7326 12.4082C4.71107 12.7508 4.61659 13.2533 4.47175 13.6657C4.44071 13.7541 4.40789 13.8389 4.37434 13.9195C4.62005 13.8524 4.91964 13.7411 5.26646 13.5579C5.48882 13.4404 5.69385 13.2901 5.9102 13.1207C5.95058 13.089 5.9922 13.056 6.03481 13.0222C6.20816 12.8848 6.39803 12.7342 6.58835 12.6102C6.7875 12.4803 7.01146 12.4447 7.20831 12.4631C7.46767 12.4875 7.73186 12.5 8 12.5C11.7089 12.5 14.5 10.1558 14.5 7.5C14.5 4.84419 11.7089 2.5 8 2.5ZM0.5 7.5C0.5 4.08068 3.97691 1.5 8 1.5C12.0231 1.5 15.5 4.08068 15.5 7.5C15.5 10.9193 12.0231 13.5 8 13.5C7.70158 13.5 7.40709 13.4861 7.11751 13.459C6.97583 13.5528 6.83777 13.6621 6.67569 13.7905C6.62832 13.828 6.5789 13.8671 6.52674 13.908C6.30071 14.085 6.03818 14.2812 5.73354 14.4421C4.73389 14.9702 3.9948 15.0302 3.62977 15.0147C3.39759 15.0048 3.20936 14.8646 3.12194 14.6754C3.03801 14.4938 3.05143 14.2816 3.15736 14.1099C3.24804 13.963 3.40655 13.6808 3.52825 13.3343C3.62961 13.0457 3.70134 12.6878 3.72712 12.4347C1.81521 11.3748 0.5 9.58517 0.5 7.5Z",fill:"currentColor"},null,-1)])])}const Be=oe(ml,[["render",pl]]),vl={width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},xl=["r"],gl={__name:"DotIcon",props:{radius:{type:Number,default:3.5}},setup(t){return(n,c)=>(o(),C("svg",vl,[f("circle",{cx:"8",cy:"8",r:t.radius,fill:"currentColor"},null,8,xl)]))}},bl={},yl={width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function _l(t,n){return o(),C("svg",yl,[...n[0]||(n[0]=[f("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M5.85355 3.14645C5.65829 2.95118 5.34171 2.95118 5.14645 3.14645L1.14645 7.14645C0.951184 7.34171 0.951184 7.65829 1.14645 7.85355L5.14645 11.8536C5.34171 12.0488 5.65829 12.0488 5.85355 11.8536C6.04882 11.6583 6.04882 11.3417 5.85355 11.1464L2.20711 7.5L5.85355 3.85355C6.04882 3.65829 6.04882 3.34171 5.85355 3.14645ZM10 8C11.933 8 13.5 9.567 13.5 11.5V12C13.5 12.2761 13.7239 12.5 14 12.5C14.2761 12.5 14.5 12.2761 14.5 12V11.5C14.5 9.01472 12.4853 7 10 7H6.6728L9.81924 3.85355C10.0145 3.65829 10.0145 3.34171 9.81924 3.14645C9.62398 2.95118 9.3074 2.95118 9.11214 3.14645L5.11214 7.14645C4.91688 7.34171 4.91688 7.65829 5.11214 7.85355L9.11214 11.8536C9.3074 12.0488 9.62398 12.0488 9.81924 11.8536C10.0145 11.6583 10.0145 11.3417 9.81924 11.1464L6.6728 8H10Z",fill:"currentColor"},null,-1)])])}const hl=oe(bl,[["render",_l]]),Cl={},kl={width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function wl(t,n){return o(),C("svg",kl,[...n[0]||(n[0]=[f("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M5.64645 3.14645C5.84171 2.95118 6.15829 2.95118 6.35355 3.14645C6.54882 3.34171 6.54882 3.65829 6.35355 3.85355L3.20711 7H10C12.4853 7 14.5 9.01472 14.5 11.5V12C14.5 12.2761 14.2761 12.5 14 12.5C13.7239 12.5 13.5 12.2761 13.5 12V11.5C13.5 9.567 11.933 8 10 8H3.20711L6.35355 11.1464C6.54882 11.3417 6.54882 11.6583 6.35355 11.8536C6.15829 12.0488 5.84171 12.0488 5.64645 11.8536L1.64645 7.85355C1.45118 7.65829 1.45118 7.34171 1.64645 7.14645L5.64645 3.14645Z",fill:"currentColor"},null,-1)])])}const $l=oe(Cl,[["render",wl]]),Sl={},Il={width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function Tl(t,n){return o(),C("svg",Il,[...n[0]||(n[0]=[f("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M5.85355 9.64645C5.65829 9.45118 5.34171 9.45118 5.14645 9.64645C4.95118 9.84171 4.95118 10.1583 5.14645 10.3536L7.64645 12.8536C7.84171 13.0488 8.15829 13.0488 8.35355 12.8536L10.8536 10.3536C11.0488 10.1583 11.0488 9.84171 10.8536 9.64645C10.6583 9.45118 10.3417 9.45118 10.1464 9.64645L8 11.7929L5.85355 9.64645ZM5.85355 6.35355C5.65829 6.54882 5.34171 6.54882 5.14645 6.35355C4.95118 6.15829 4.95118 5.84171 5.14645 5.64645L7.64645 3.14645C7.84171 2.95118 8.15829 2.95118 8.35355 3.14645L10.8536 5.64645C11.0488 5.84171 11.0488 6.15829 10.8536 6.35355C10.6583 6.54882 10.3417 6.54882 10.1464 6.35355L8 4.20711L5.85355 6.35355Z",fill:"currentColor"},null,-1)])])}const Vl=oe(Sl,[["render",Tl]]),Bl={class:"mx-6 md:mx-10 flex items-center gap-2 border-y py-2.5"},Ll={class:"flex flex-wrap gap-2 px-10"},El={class:"flex justify-between overflow-scroll pl-10 py-2.5 items-center"},Fl={class:"flex items-center overflow-x-auto w-[60%]"},Al={class:"flex gap-1"},Ml={class:"flex items-center justify-end space-x-2 sm:mt-0 w-[40%] mr-9"},jl=P({__name:"EmailEditor",props:Z({placeholder:{type:String,default:null},label:{type:String,default:"Send"},editable:{type:Boolean,default:!0},doctype:{type:String,default:"HD Ticket"},toEmails:{type:Array,default:()=>[]},ccEmails:{type:Array,default:()=>[]},bccEmails:{type:Array,default:()=>[]}},{modelValue:{},modelModifiers:{}}),emits:Z(["submit","discard"],["update:modelValue"]),setup(t,{expose:n,emit:c}){const a=I(null),s=I(!1),m=t,r=T(()=>R.loading?"Sending...":m.label),u=c,g=ne(t,"modelValue"),d=at("emailBoxContent"+g.value.name,null),{updateOnboardingStep:v}=Ke("helpdesk"),{isManager:i}=Le(),w=I([]),B=T(()=>ye(d.value)),$=I([...m.toEmails]),p=I([...m.ccEmails]),b=I([...m.bccEmails]),k=I(!1),l=I(!1),y=T(()=>{var N;return!!((N=p.value)!=null&&N.length)}),_=T(()=>{var N;return!!((N=b.value)!=null&&N.length)}),F=I(null),D=I(null);function S(N){d.value=N.message,s.value=!1}const R=se({url:"run_doc_method",makeParams:()=>{var N,E;return{dt:m.doctype,dn:g.value.name,method:"reply_via_agent",args:{attachments:w.value.map(Q=>Q.name),to:$.value.join(","),cc:(N=p.value)==null?void 0:N.join(","),bcc:(E=b.value)==null?void 0:E.join(","),message:d.value}}},onSuccess:()=>{gt(),u("submit"),i&&v("reply_on_ticket")},debounce:300});function M(){if(ye(d.value))return!1;if(!$.value.length)return pe.warning("Email has no recipients. Please add at least one email address in the 'TO' field."),!1;R.submit()}function J(){k.value=!k.value,k.value&&ve(()=>{F.value.setFocus()})}function pt(){l.value=!l.value,l.value&&ve(()=>{D.value.setFocus()})}async function vt(N){w.value=w.value.filter(E=>E!==N),await st(N.name)}function xt(N,E,Q,Ae){$.value=E,p.value=Q,b.value=Ae,a.value.editor.chain().clearContent().insertContent(N).focus("all").setBlockquote().insertContentAt(0,{type:"paragraph"}).focus("start").run()}function gt(){d.value=null,w.value=[]}function bt(){w.value=[],d.value=null,p.value=[],b.value=[],p.value=[],k.value=!1,l.value=!1,u("discard")}const yt=T(()=>a.value.editor);return n({addToReply:xt,editor:yt,submitMail:M}),(N,E)=>{const Q=A("Button"),Ae=A("FeatherIcon");return o(),C(q,null,[x(e(Fe),{ref_key:"editorRef",ref:a,"editor-class":["prose-sm max-w-full mx-6 md:mx-10 max-h-[50vh] py-3","min-h-[7rem]",e(ze)(e(d)),t.editable&&"!max-h-[35vh] overflow-y-auto"],content:e(d),"starterkit-options":{heading:{levels:[2,3,4,5,6]}},placeholder:t.placeholder,editable:t.editable,onChange:E[8]||(E[8]=O=>t.editable?d.value=O:null),extensions:[e(rt)],uploadFunction:O=>{var G;return e(nt)(O,t.doctype,(G=t.modelValue)==null?void 0:G.name)}},{top:h(()=>[f("div",Bl,[E[10]||(E[10]=f("span",{class:"text-xs text-gray-500"},"TO:",-1)),x(e(je),{modelValue:$.value,"onUpdate:modelValue":E[0]||(E[0]=O=>$.value=O),class:"flex-1",validate:e(Me),"error-message":O=>`${O} is an invalid email address`},null,8,["modelValue","validate","error-message"]),x(Q,{label:"CC",class:H([y.value?"bg-gray-300 hover:bg-gray-200":""]),onClick:E[1]||(E[1]=O=>J())},null,8,["class"]),x(Q,{label:"BCC",class:H([_.value?"bg-gray-300 hover:bg-gray-200":""]),onClick:E[2]||(E[2]=O=>pt())},null,8,["class"])]),k.value||y.value?(o(),C("div",{key:0,class:H(["mx-10 flex items-center gap-2 py-2.5",y.value||k.value?"border-b":""])},[E[11]||(E[11]=f("span",{class:"text-xs text-gray-500"},"CC:",-1)),x(e(je),{ref_key:"ccInput",ref:F,modelValue:p.value,"onUpdate:modelValue":E[3]||(E[3]=O=>p.value=O),class:"flex-1",validate:e(Me),"error-message":O=>`${O} is an invalid email address`},null,8,["modelValue","validate","error-message"])],2)):j("",!0),l.value||_.value?(o(),C("div",{key:1,class:H(["mx-10 flex items-center gap-2 py-2.5",_.value||l.value?"border-b":""])},[E[12]||(E[12]=f("span",{class:"text-xs text-gray-500"},"BCC:",-1)),x(e(je),{ref_key:"bccInput",ref:D,modelValue:b.value,"onUpdate:modelValue":E[4]||(E[4]=O=>b.value=O),class:"flex-1",validate:e(Me),"error-message":O=>`${O} is an invalid email address`},null,8,["modelValue","validate","error-message"])],2)):j("",!0)]),bottom:h(()=>{var O;return[f("div",Ll,[(o(!0),C(q,null,K(w.value,G=>(o(),V(e(Ee),{key:G.file_url,label:G.file_name,url:["MOV","MP4"].includes(G.file_type)?null:G.file_url},{suffix:h(()=>[x(Ae,{class:"h-3.5",name:"x",onClick:Y(_t=>vt(G),["self","stop"])},null,8,["onClick"])]),_:2},1032,["label","url"]))),128))]),f("div",El,[f("div",Fl,[f("div",Al,[x(e(dt),{"upload-args":{doctype:t.doctype,docname:(O=t.modelValue)==null?void 0:O.name,private:!0},onSuccess:E[5]||(E[5]=G=>{w.value.push(G)})},{default:h(({openFileSelector:G})=>[x(Q,{variant:"ghost",onClick:_t=>G()},{icon:h(()=>[x(e(ft),{class:"h-4",style:{color:"#000000","stroke-width":"1.5 !important"}})]),_:2},1032,["onClick"])]),_:1},8,["upload-args"]),x(Q,{variant:"ghost",onClick:E[6]||(E[6]=G=>s.value=!0)},{icon:h(()=>[x(e(we),{class:"h-4",style:{color:"#000000","stroke-width":"1.2"}})]),_:1})]),x(e(ct),{class:"ml-1",buttons:e(Ne)},null,8,["buttons"])]),f("div",Ml,[x(Q,{label:"Discard",onClick:bt}),x(Q,{variant:"solid",disabled:B.value,loading:e(R).loading,label:r.value,onClick:E[7]||(E[7]=()=>{M()})},null,8,["disabled","loading","label"])])])]}),_:1},8,["editor-class","content","placeholder","editable","extensions","uploadFunction"]),x(e(Ja),{modelValue:s.value,"onUpdate:modelValue":E[9]||(E[9]=O=>s.value=O),doctype:t.doctype,onApply:S},null,8,["modelValue","doctype"])],64)}}}),Rl=It("agent",()=>{const t=Ue({doctype:"HD Agent",fields:["name","agent_name","user","user.user_image"],filters:{is_active:1},pageLength:99999}),n=T(()=>{var a;return(a=t.data)==null?void 0:a.map(s=>({label:s.agent_name,value:s.name}))});function c(a){return t.data.filter(s=>{var m;return(m=s.user)==null?void 0:m.toLowerCase().includes(a.toLowerCase())})}return{dropdown:n,agents:t,searchAgents:c}}),Dl={key:0,class:"flex flex-col gap-2 px-6 md:pl-10 md:pr-9"},Ol={class:"flex flex-wrap gap-2"},Pl={class:"flex justify-between overflow-hidden border-t py-2.5"},ql={class:"flex items-center overflow-x-auto w-[60%]"},Ul={class:"flex items-center justify-end space-x-2 w-[40%]"},Nl=P({__name:"CommentTextEditor",props:Z({placeholder:{type:String,default:null},label:{type:String,default:"Comment"},editable:{type:Boolean,default:!0},doctype:{type:String,default:"HD Ticket"}},{modelValue:{},modelModifiers:{}}),emits:Z(["submit","discard"],["update:modelValue"]),setup(t,{expose:n,emit:c}){const{updateOnboardingStep:a}=Ke("helpdesk"),{agents:s}=Rl(),{isManager:m}=Le();ae(()=>{var y;s.loading||(y=s.data)!=null&&y.length||s.list.promise||s.fetch()});const r=t,u=c,g=ne(t,"modelValue"),d=at("commentBoxContent"+g.value.name,null),v=I([]),i=T(()=>ye(d.value)),w=I(!1),B=T(()=>w.value?"Sending...":r.label),$=T(()=>{var y;return((y=s.data)==null?void 0:y.map(_=>({label:_.agent_name.trimEnd(),value:_.name})))||[]});function p(y){v.value=v.value.filter(_=>_!==y),st(y.name)}async function b(){if(ye(d.value))return!1;se({url:"run_doc_method",makeParams:()=>({dt:r.doctype,dn:g.value.name,method:"new_comment",args:{content:d.value,attachments:v.value}}),onSuccess:()=>{m&&a("comment_on_ticket"),u("submit"),w.value=!1,v.value=[],d.value=null},onError:()=>{w.value=!1}}).submit()}const k=I(null),l=T(()=>{var y;return(y=k.value)==null?void 0:y.editor});return n({submitComment:b,editor:l}),(y,_)=>{const F=A("FeatherIcon"),D=A("Button");return e(s).data?(o(),V(e(Fe),{key:0,ref_key:"editorRef",ref:k,"editor-class":["prose-sm max-w-none",t.editable&&"min-h-[7rem] mx-6 md:ml-10 md:mr-9 max-h-[50vh] overflow-y-auto border-t py-3",e(ze)(e(d))],content:e(d),"starterkit-options":{heading:{levels:[2,3,4,5,6]}},placeholder:t.placeholder,editable:t.editable,mentions:$.value,onChange:_[3]||(_[3]=S=>t.editable?d.value=S:null),extensions:[e(rt)],uploadFunction:S=>{var R;return e(nt)(S,t.doctype,(R=t.modelValue)==null?void 0:R.name)}},{bottom:h(()=>[t.editable?(o(),C("div",Dl,[f("div",Ol,[(o(!0),C(q,null,K(v.value,S=>(o(),V(e(Ee),{key:S.file_url,label:S.file_name,url:["MOV","MP4"].includes(S.file_type)?null:S.file_url},{suffix:h(()=>[x(F,{class:"h-3.5",name:"x",onClick:Y(R=>p(S),["stop"])},null,8,["onClick"])]),_:2},1032,["label","url"]))),128))]),f("div",Pl,[f("div",ql,[x(e(ct),{class:"-ml-1",buttons:e(Ne)},null,8,["buttons"]),x(e(dt),{"upload-args":{doctype:t.doctype,docname:t.modelValue.name,private:!0},onSuccess:_[0]||(_[0]=S=>v.value.push(S))},{default:h(({openFileSelector:S})=>[x(D,{theme:"gray",variant:"ghost",onClick:R=>S()},{icon:h(()=>[x(e(ft),{class:"h-4",style:{color:"#000000","stroke-width":"1.5 !important"}})]),_:2},1032,["onClick"])]),_:1},8,["upload-args"])]),f("div",Ul,[x(D,{label:"Discard",onClick:_[1]||(_[1]=()=>{d.value="",v.value=[],u("discard")})}),x(D,{variant:"solid",label:B.value,disabled:i.value,loading:w.value,onClick:_[2]||(_[2]=()=>{w.value=!0,b(),d.value=""})},null,8,["label","disabled","loading"])])])])):j("",!0)]),_:1},8,["editor-class","content","placeholder","editable","mentions","extensions","uploadFunction"])):j("",!0)}}}),zl={class:"flex flex-wrap gap-1"},Hl={class:"flex-1"},Kl={class:"mt-1 rounded-lg bg-white py-1 text-base shadow-2xl"},Zl={class:"flex flex-col gap-1 p-1 text-gray-800"},Gl={class:"text-base font-medium"},Wl={class:"text-sm text-gray-600"},je=P({__name:"MultiSelectInput",props:Z({validate:{type:Function,default:null},errorMessage:{type:Function,default:t=>`${t} is an Invalid value`}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(t,{expose:n}){const c=t,a=ne(t,"modelValue"),s=I([]),m=I(null),r=I(null),u=I(""),g=I(""),d=I(!1),v=T({get:()=>u.value||"",set:l=>{u.value="",l&&(d.value=!1),l!=null&&l.value&&$(l.value)}});Tt(u,l=>{l=l||"",g.value!==l&&(g.value=l,B(l))},{debounce:300,immediate:!0});const i=se({url:"helpdesk.api.contact.search_contacts",method:"GET",cache:["Contact",g.value],params:{txt:g.value},transform:l=>l.map(({full_name:y,email_id:_,name:F})=>({label:y||F||_,value:_}))}),w=T(()=>{let l=i.data||[];return!l.length&&u.value&&l.push({label:u.value,value:u.value}),l});function B(l){i.update({params:{txt:l}}),i.reload()}const $=l=>{r.value=null,l&&(l.split(",").forEach(_=>{var F;if(_=_.trim(),_&&!((F=a.value)!=null&&F.includes(_))){if(_&&c.validate&&!c.validate(_)){r.value=c.errorMessage(_);return}a.value?a.value.push(_):a.value=[_],_=_.replace(_,"")}}),!r.value&&(l=""))},p=l=>{a.value=a.value.filter(y=>y!==l)},b=()=>{var y;if(u.value)return;let l=(y=s.value[s.value.length-1])==null?void 0:y.$el;document.activeElement===l?(a.value.pop(),ve(()=>{a.value.length?(l=s.value[s.value.length-1].$el,l==null||l.focus()):k()})):l==null||l.focus()};function k(){m.value.$el.focus()}return n({setFocus:k}),(l,y)=>{const _=A("FeatherIcon"),F=A("Button"),D=A("ErrorMessage");return o(),C("div",null,[f("div",zl,[(o(!0),C(q,null,K(a.value,S=>(o(),V(F,{ref_for:!0,ref_key:"emails",ref:s,key:S,label:S,theme:"gray",variant:"subtle",class:"rounded-full",onKeydownCapture:fe(Y(b,["stop"]),["delete"])},{suffix:h(()=>[x(_,{class:"h-3.5",name:"x",onClick:Y(R=>p(S),["stop"])},null,8,["onClick"])]),_:2},1032,["label","onKeydownCapture"]))),128)),f("div",Hl,[x(e(Ft),{modelValue:v.value,"onUpdate:modelValue":y[2]||(y[2]=S=>v.value=S),nullable:""},{default:h(()=>[x(e(Vt),{show:d.value,"onUpdate:show":y[1]||(y[1]=S=>d.value=S),class:"w-full"},{target:h(({togglePopover:S})=>[x(e(Bt),{ref_key:"search",ref:m,class:"search-input form-input w-full border-none bg-white hover:bg-white focus:border-none focus:!shadow-none focus-visible:!ring-0",type:"text",value:u.value,autocomplete:"off",onChange:y[0]||(y[0]=R=>{u.value=R.target.value,d.value=!0}),onFocus:()=>S(),onKeydownCapture:fe(Y(b,["stop"]),["delete"])},null,8,["value","onFocus","onKeydownCapture"])]),body:h(({isOpen:S})=>[De(f("div",null,[f("div",Kl,[x(e(Lt),{class:"my-1 max-h-[12rem] overflow-y-auto px-1.5",static:""},{default:h(()=>[(o(!0),C(q,null,K(w.value,R=>(o(),V(e(Et),{key:R.value,value:R},{default:h(({active:M})=>[f("li",{class:H(["flex cursor-pointer items-center rounded px-2 py-1 text-base",{"bg-gray-100":M}])},[x(e(Te),{class:"mr-2",name:R.value,size:"lg"},null,8,["name"]),f("div",Zl,[f("div",Gl,L(R.label),1),f("div",Wl,L(R.value),1)])],2)]),_:2},1032,["value"]))),128))]),_:1})])],512),[[Oe,S]])]),_:1},8,["show"])]),_:1},8,["modelValue"])])]),r.value?(o(),V(D,{key:0,class:"mt-2 pl-2",message:r.value},null,8,["message"])):j("",!0)])}}}),Jl={class:"flex flex-col comm-area"},Yl={class:"flex justify-between gap-3 border-t px-6 md:px-10 py-4 md:py-2.5"},Ql={class:"flex gap-1.5"},Xl=["onKeydownCapture"],ea=["onKeydownCapture"],jn=P({__name:"CommunicationArea",props:Z({doctype:{type:String,default:"HD Ticket"},toEmails:{type:Array,default:()=>[]},ccEmails:{type:Array,default:()=>[]},bccEmails:{type:Array,default:()=>[]}},{content:{},contentModifiers:{},modelValue:{},modelModifiers:{}}),emits:Z(["update"],["update:content","update:modelValue"]),setup(t,{expose:n,emit:c}){const a=c,s=ne(t,"content"),m=ne(t,"modelValue"),{isMac:r}=At(),{isMobileView:u}=ot(),g=I(null),d=I(null);function v(){le.value&&(le.value=!1),te.value=!te.value}function i(){te.value&&(te.value=!1),le.value=!le.value}function w(){g.value.submitMail()&&a("update")}function B(){d.value.submitComment()&&a("update")}function $(p){var b,k,l;te.value=!0,g.value.addToReply(p.content,(b=p.to)==null?void 0:b.split(","),(k=p.cc)==null?void 0:k.split(","),(l=p.bcc)==null?void 0:l.split(","))}return re(()=>te.value,p=>{var b,k,l;p&&((l=(k=(b=g.value)==null?void 0:b.editor)==null?void 0:k.commands)==null||l.focus())}),re(()=>le.value,p=>{var b,k,l;p&&((l=(k=(b=d.value)==null?void 0:b.editor)==null?void 0:k.commands)==null||l.focus())}),n({replyToEmail:$,toggleEmailBox:v,toggleCommentBox:i,editor:g}),(p,b)=>{const k=A("Button");return o(),C("div",Jl,[f("div",Yl,[f("div",Ql,[x(k,{ref:"sendEmailRef",variant:"ghost",label:"Reply",class:H([e(te)?"!bg-gray-300 hover:!bg-gray-200":""]),onClick:b[0]||(b[0]=l=>v())},{prefix:h(()=>[x(e(we),{class:"h-4"})]),_:1},8,["class"]),x(k,{variant:"ghost",label:"Comment",class:H([e(le)?"!bg-gray-300 hover:!bg-gray-200":""]),onClick:b[1]||(b[1]=l=>i())},{prefix:h(()=>[x(e(Be),{class:"h-4"})]),_:1},8,["class"])])]),De(f("div",{class:"flex gap-1.5 flex-1",onKeydownCapture:[fe(Y(w,["ctrl","stop"]),["enter"]),fe(Y(w,["meta","stop"]),["enter"])]},[x(e(jl),{ref_key:"emailEditorRef",ref:g,label:e(u)?"Send":e(r)?"Send (⌘ + ⏎)":"Send (Ctrl + ⏎)",modelValue:m.value,"onUpdate:modelValue":b[2]||(b[2]=l=>m.value=l),content:s.value,"onUpdate:content":b[3]||(b[3]=l=>s.value=l),placeholder:"Hi John, we are looking into this issue.","to-emails":t.toEmails,"cc-emails":t.ccEmails,"bcc-emails":t.bccEmails,onSubmit:b[4]||(b[4]=()=>{te.value=!1,a("update")}),onDiscard:b[5]||(b[5]=()=>{te.value=!1})},null,8,["label","modelValue","content","to-emails","cc-emails","bcc-emails"])],40,Xl),[[Oe,e(te)]]),De(f("div",{onKeydownCapture:[fe(Y(B,["ctrl","stop"]),["enter"]),fe(Y(B,["meta","stop"]),["enter"])]},[x(e(Nl),{ref_key:"commentTextEditorRef",ref:d,label:e(u)?"Comment":e(r)?"Comment (⌘ + ⏎)":"Comment (Ctrl + ⏎)",modelValue:m.value,"onUpdate:modelValue":b[6]||(b[6]=l=>m.value=l),editable:e(le),doctype:t.doctype,placeholder:"@John could you please look into this?",onSubmit:b[7]||(b[7]=()=>{le.value=!1,a("update")}),onDiscard:b[8]||(b[8]=()=>{le.value=!1})},null,8,["label","modelValue","editable","doctype"])],40,ea),[[Oe,e(le)]])])}}}),ta={class:"flex flex-col gap-4"},la={class:"flex items-center gap-2 rounded-md p-2 ring-1 ring-gray-200"},aa=P({__name:"TicketSplitModal",props:Z({ticket_id:{},communication_id:{}},{modelValue:{type:Boolean},modelModifiers:{}}),emits:Z(["update"],["update:modelValue"]),setup(t,{emit:n}){const c=t,a=ne(t,"modelValue"),s=I(null),m=se({url:"helpdesk.helpdesk.doctype.hd_ticket.api.split_ticket",makeParams({subject:u,communication_id:g}){return{subject:u,communication_id:g}},validate({subject:u,communication_id:g}){if(!u)throw{message:"Subject is required"};if(!g)throw{message:"Communication ID is required"}},onSuccess:u=>{pe.success("Ticket split successfully"),a.value=!1,window.open(window.location.origin+"/helpdesk/tickets/"+u,"_blank"),window.location.reload()}});function r(){m.submit({subject:s.value,communication_id:c.communication_id})}return(u,g)=>{const d=A("FormControl"),v=A("Button");return o(),V(e(it),{options:{title:"Split ticket"},modelValue:a.value,"onUpdate:modelValue":g[1]||(g[1]=i=>a.value=i)},{"body-content":h(()=>[f("div",ta,[g[3]||(g[3]=f("p",{class:"text-p-base text-ink-gray-8"},[xe(" All "),f("span",{class:"underline"},"emails/ comments"),xe(" from this email onwards will be moved to new ticket. ")],-1)),x(d,{label:"New Ticket Subject",type:"text",modelValue:s.value,"onUpdate:modelValue":g[0]||(g[0]=i=>s.value=i),placeholder:"Add a subject for the new ticket"},null,8,["modelValue"]),f("div",la,[x(e(Ut),{class:"h-6 w-5 w-min-5 w-max-5 min-h-5 max-w-5 text-yellow-500"}),g[2]||(g[2]=f("div",{class:"text-wrap text-sm text-gray-700"}," This action is irreversible. ",-1))])])]),actions:h(()=>[x(v,{class:"w-full",variant:"solid",label:"Split into new ticket",loading:e(m).loading,"icon-left":e(ut),onClick:r},null,8,["loading","icon-left"])]),_:1},8,["modelValue"])}}}),na={key:0,class:"flex items-center gap-2 text-sm"},sa={class:"leading-tight"},oa={class:"text-xs md:text-sm text-gray-600"},ia={key:0,class:"sm:flex hidden text-sm text-gray-600"},ra={key:1,class:"flex items-center gap-1"},ua={key:0,class:"sm:flex hidden text-sm text-gray-600"},da={class:"flex gap-0.5 items-center"},ca={class:"text-xs md:text-sm text-gray-600"},ma={class:"text-sm leading-5 text-gray-600"},fa={key:0,class:"text-2xs mr-1 font-bold text-gray-500"},pa={key:1},va={key:2},xa={key:3,class:"text-2xs mr-1 font-bold text-gray-500"},ga={key:4},ba={key:5},ya={key:6,class:"text-2xs mr-1 font-bold text-gray-500"},_a={key:7},ha={class:"flex flex-wrap gap-2"},Ca=P({__name:"EmailArea",props:{activity:{type:Object,required:!0},showSplitOption:{type:Boolean,default:!1}},emits:["reply"],setup(t,{emit:n}){const c=t,{sender:a,to:s,cc:m,bcc:r,creation:u,subject:g,attachments:d,content:v,name:i,deliveryStatus:w}=c.activity;console.log(w);const B=n,{isMobileView:$}=ot(),p=I(!1),b=T(()=>{let k=w,l="red";return["Sent","Clicked"].includes(k)?l="green":["Sending","Scheduled"].includes(k)?l="orange":["Opened","Read"].includes(k)?l="blue":k=="Error"&&(l="red"),{label:k,color:l}});return(k,l)=>{const y=A("Tooltip"),_=A("Badge"),F=A("Button"),D=Kt;return o(),C(q,null,[f("div",ke(k.$attrs,{class:"grow cursor-pointer border-transparent bg-white rounded-md shadow text-base leading-6 transition-all duration-300 ease-in-out"}),[f("div",{class:H(["flex items-center justify-between gap-2",e($)&&"items-start"])},[e($)?(o(),C("div",na,[f("div",sa,[f("p",null,L(e(a).full_name||"No name found"),1),x(y,{text:e(ue)(e(u),e(de))},{default:h(()=>[f("p",oa,L(e(_e)(e(u))),1)]),_:1},8,["text"]),e(a).name?(o(),C("p",ia,L("<"+e(a).name+">"),1)):j("",!0)])])):(o(),C("div",ra,[f("span",null,L(e(a).full_name||"No name found"),1),e(a).name?(o(),C("span",ua,L("<"+e(a).name+">"),1)):j("",!0)])),f("div",da,[b.value.label?(o(),V(_,{key:0,label:k.__(b.value.label),variant:"subtle",theme:b.value.color,class:"mr-1.5"},null,8,["label","theme"])):j("",!0),e($)?j("",!0):(o(),V(y,{key:1,text:e(ue)(e(u),e(de))},{default:h(()=>[f("p",ca,L(e(_e)(e(u))),1)]),_:1},8,["text"])),x(F,{variant:"ghost",class:"text-gray-700",onClick:l[0]||(l[0]=S=>{var R;return B("reply",{content:e(v),to:((R=e(a))==null?void 0:R.name)??e(s)})})},{default:h(()=>[x(e($l),{class:"h-4 w-4"})]),_:1}),x(F,{variant:"ghost",class:"text-gray-700",onClick:l[1]||(l[1]=S=>B("reply",{content:e(v),to:e(s)??e(a).name,cc:e(m),bcc:e(r)}))},{default:h(()=>[x(e(hl),{class:"h-4 w-4"})]),_:1}),t.showSplitOption?(o(),V(e(Ge),{key:2,placement:"right",options:[{label:"Split Ticket",icon:e(ut),onClick:()=>p.value=!0}]},{default:h(()=>[x(F,{icon:"more-horizontal",class:"text-gray-600",variant:"ghost"})]),_:1},8,["options"])):j("",!0)])],2),f("div",ma,[e(s)?(o(),C("span",fa,"TO:")):j("",!0),e(s)?(o(),C("span",pa,L(e(s)),1)):j("",!0),e(m)?(o(),C("span",va,", ")):j("",!0),e(m)?(o(),C("span",xa," CC: ")):j("",!0),e(m)?(o(),C("span",ga,L(e(m)),1)):j("",!0),e(r)?(o(),C("span",ba,", ")):j("",!0),e(r)?(o(),C("span",ya," BCC: ")):j("",!0),e(r)?(o(),C("span",_a,L(e(r)),1)):j("",!0)]),l[3]||(l[3]=f("div",{class:"border-0 border-t my-3 border-outline-gray-modals"},null,-1)),x(D,{content:e(v)},null,8,["content"]),f("div",ha,[(o(!0),C(q,null,K(e(d),S=>(o(),V(e(Ee),{key:S.file_url,label:S.file_name,url:S.file_url},null,8,["label","url"]))),128))])],16),x(aa,{modelValue:p.value,"onUpdate:modelValue":l[2]||(l[2]=S=>p.value=S),ticket_id:e(i),communication_id:e(i)},null,8,["modelValue","ticket_id","communication_id"])],64)}}}),ka={class:"mb-1 ml-0.5 flex items-center justify-between"},wa={class:"text-gray-600 flex items-center gap-2"},$a={class:"font-medium text-gray-800"},Sa={class:"flex items-center gap-1"},Ia={class:"pl-0.5 text-sm text-gray-600"},Ta={key:0},Va={class:"rounded bg-gray-50 px-4 py-3"},Ba={class:"flex flex-row-reverse gap-2"},La={key:0,class:"flex flex-wrap gap-2"},Ea=P({__name:"CommentBox",props:{activity:{type:Object,required:!0}},emits:["update"],setup(t,{emit:n}){const c=Le(),a=t,{getUser:s}=He(),{name:m,creation:r,content:u,commenter:g,commentedBy:d,attachments:v}=a.activity,i=T(()=>/has been merged with ticket #\d+/.test(u)),w=n,B=I(!1),$=I(!1),p=I(u),b=I(null),k=I(null);function l(){$.value=!0,k.value.editor.chain().focus("start")}function y(){p.value=u,$.value=!1}const _=se({url:"frappe.client.delete",makeParams:()=>({doctype:"HD Ticket Comment",name:m}),onSuccess(){w("update"),pe.success("Comment deleted")}});function F(){if(u===p.value){$.value=!1;return}if(ye(p.value)){pe.error("Comment cannot be empty");return}Nt.submit({doctype:"HD Ticket Comment",name:m,fieldname:"content",value:p.value},{onSuccess:()=>{$.value=!1,w("update"),pe.success("Comment updated")}})}return ae(()=>{b.value.style.width="0px"}),(D,S)=>{const R=A("Tooltip"),M=A("Button");return o(),C(q,null,[f("div",{class:"flex-col text-base flex-1",ref_key:"commentBoxRef",ref:b},[f("div",ka,[f("div",wa,[x(e(Ze),{size:"md",label:e(g),image:e(s)(e(d)).user_image},null,8,["label","image"]),f("p",null,[f("span",$a,L(e(g)),1),S[2]||(S[2]=f("span",null," added a",-1)),S[3]||(S[3]=f("span",{class:"max-w-xs truncate font-medium text-gray-800"}," comment ",-1))])]),f("div",Sa,[x(R,{text:e(ue)(e(r),e(de))},{default:h(()=>[f("span",Ia,L(e(_e)(e(r))),1)]),_:1},8,["text"]),e(c).userId===e(d)&&!$.value?(o(),C("div",Ta,[x(e(Ge),{placement:"right",options:[{label:"Edit",onClick:()=>l(),icon:"edit-2",condition:()=>!i.value},{label:"Delete",onClick:()=>B.value=!0,icon:"trash-2"}]},{default:h(()=>[x(M,{icon:"more-horizontal",class:"text-gray-600",variant:"ghost"})]),_:1},8,["options"])])):j("",!0)])]),f("div",Va,[x(e(Fe),{ref_key:"editorRef",ref:k,"editor-class":["prose-f shrink text-p-sm transition-all duration-300 ease-in-out block w-full content",e(ze)(p.value)],content:p.value,editable:$.value,"bubble-menu":e(Ne),onChange:S[0]||(S[0]=J=>{p.value=J})},Mt({_:2},[$.value?{name:"bottom",fn:h(()=>[f("div",Ba,[x(M,{label:"Save",onClick:F,variant:"solid"}),x(M,{label:"Discard",onClick:y})])]),key:"0"}:void 0]),1032,["editor-class","content","editable","bubble-menu"]),$.value?j("",!0):(o(),C("div",La,[(o(!0),C(q,null,K(e(v),J=>(o(),V(e(Ee),{key:J.file_url,label:J.file_name,url:J.file_url},null,8,["label","url"]))),128))]))])],512),x(e(it),{modelValue:B.value,"onUpdate:modelValue":S[1]||(S[1]=J=>B.value=J),options:{title:"Delete Comment",message:"Are you sure you want to confirm this action?",actions:[{label:"Cancel",onClick:()=>B.value=!1},{label:"Delete",onClick:()=>e(_).submit(),variant:"solid"}]}},null,8,["modelValue","options"])],64)}}}),Fa={class:"flex-1"},Aa={class:"mt-1.5 flex justify-between text-base items-start md:items-center"},Ma={key:0,class:"inline-flex flex-wrap gap-1.5 text-ink-gray-8 font-medium w-4/5"},ja={key:1,class:"text-gray-600 w-4/6"},Ra={class:"font-medium text-gray-800"},Da={class:"text-gray-600 text-sm w-2/6 flex justify-end"},Oa={key:0},Pa={class:"text-gray-600 w-4/6"},qa={class:"font-medium text-gray-800"},Ua={class:"text-gray-600 text-sm w-2/6 flex justify-end"},Na=P({__name:"HistoryBox",props:{activity:{type:Object,required:!0}},setup(t){const n=t,{user:c,content:a,creation:s,relatedActivities:m}=n.activity;let r=I(!1);return(u,g)=>{const d=A("Button"),v=A("Tooltip");return o(),C("div",Fa,[f("div",Aa,[e(m).length>1?(o(),C("div",Ma,[f("span",null,L(`${e(r)?"Hide ":"Show "}`),1),f("span",null,"+"+L(e(m).length),1),g[1]||(g[1]=f("span",null,"changes from ",-1)),f("span",null,L(e(c)),1),x(d,{class:"!size-4",variant:"ghost",onClick:g[0]||(g[0]=i=>jt(r)?r.value=!e(r):r=!e(r))},{icon:h(()=>[x(e(Vl))]),_:1})])):(o(),C("div",ja,[f("span",Ra,L(e(c)),1),f("span",null,L(e(a)),1)])),x(v,{text:e(ue)(e(s),e(de))},{default:h(()=>[f("div",Da,L(e(_e)(e(s))),1)]),_:1},8,["text"])]),e(r)?(o(),C("div",Oa,[(o(!0),C(q,null,K(e(m),i=>(o(),C("div",{key:i.creation,class:"mt-2 flex justify-between text-base"},[f("div",Pa,[f("span",qa,L(i.user),1),f("span",null,L(i.content),1)]),x(v,{text:e(ue)(i.creation,e(de))},{default:h(()=>[f("div",Ua,L(e(_e)(i.creation)),1)]),_:2},1032,["text"])]))),128))])):j("",!0)])}}}),za={class:"mt-3 flex flex-wrap items-center gap-2"},Rn=P({__name:"AssignmentModal",props:Z({doctype:{type:String,required:!0},docname:{type:String,required:!0},assignees:{type:Array,required:!0},team:{type:String,default:""}},{modelValue:{},modelModifiers:{}}),emits:Z(["update"],["update:modelValue"]),setup(t,{emit:n}){const c=t,a=ne(t,"modelValue"),s=n,{getUser:m}=He(),{updateOnboardingStep:r}=Ke("helpdesk"),{isManager:u}=Le(),{teamRestrictionApplied:g,assignWithinTeam:d}=Rt(),v=I(""),i=l=>{v.value="",se({url:"frappe.desk.form.assign_to.add",auto:!0,params:{doctype:c.doctype,name:c.docname,assign_to:[l]},onSuccess:()=>{s("update"),u&&r("assign_to_agent"),p.value=p.value.filter(y=>y.value!==l)}}),s("update")},w=l=>{se({url:"frappe.desk.form.assign_to.remove",auto:!0,params:{doctype:c.doctype,name:c.docname,assign_to:l},onSuccess:()=>{s("update"),p.value.push({label:l,value:l})}})},B=T(()=>{var y;const l={};return l.is_active=["=",1],(y=c.assignees)!=null&&y.length&&(l.name=["not in",[...c.assignees.map(_=>_.name)]]),l}),$=I(""),p=I([]);async function b(){let l=await Dt("helpdesk.helpdesk.doctype.hd_team.hd_team.get_team_members",{team:c.team}),y=c.assignees.map(_=>_.name);l=l.filter(_=>!y.includes(_)),p.value=l.map(_=>({label:_,value:_}))}const k=T(()=>g&&d&&c.team);return ae(()=>{k.value&&b()}),(l,y)=>{const _=A("Tooltip"),F=A("FeatherIcon"),D=A("Button"),S=A("ErrorMessage"),R=A("Dialog");return o(),V(R,{modelValue:a.value,"onUpdate:modelValue":y[2]||(y[2]=M=>a.value=M),options:{title:"Assign To",size:"xl"}},{"body-content":h(()=>[k.value?(o(),V(e(zt),{key:0,placeholder:"Search agents","model-value":$.value,options:p.value,"onUpdate:modelValue":y[0]||(y[0]=({_:M,value:J})=>{i(J)})},{"item-prefix":h(({option:M})=>[x(e(Te),{class:"mr-2",name:M.value,size:"sm"},null,8,["name"])]),"item-label":h(({option:M})=>[x(_,{text:M.value},{default:h(()=>[xe(L(e(m)(M.value).full_name),1)]),_:2},1032,["text"])]),_:1},8,["model-value","options"])):(o(),V(e(nl),{key:1,class:"form-control",doctype:"HD Agent","custom-filters":B.value,"reset-input":!0,onChange:y[1]||(y[1]=M=>{i(M.value)})},{"item-prefix":h(({option:M})=>[x(e(Te),{class:"mr-2",name:M.value,size:"sm"},null,8,["name"])]),"item-label":h(({option:M})=>[x(_,{text:M.value},{default:h(()=>[xe(L(e(m)(M.value).full_name),1)]),_:2},1032,["text"])]),_:1},8,["custom-filters"])),f("div",za,[(o(!0),C(q,null,K(t.assignees,M=>(o(),V(_,{key:M.name,text:M.name},{default:h(()=>[x(D,{label:e(m)(M.name).full_name,theme:"gray",variant:"outline"},{prefix:h(()=>[x(e(Te),{name:M.name,size:"sm"},null,8,["name"])]),suffix:h(()=>[x(F,{class:"h-3.5",name:"x",onClick:Y(J=>w(M.name),["stop"])},null,8,["onClick"])]),_:2},1032,["label"])]),_:2},1032,["text"]))),128))]),v.value?(o(),V(S,{key:2,class:"mt-2",message:v.value},null,8,["message"])):j("",!0)]),_:1},8,["modelValue"])}}}),Ha={key:0,class:"mt-2 grid max-h-[560px] grid-cols-1 md:grid-cols-3 gap-2 overflow-y-auto"},Ka=["onClick"],Za={class:"border-b pb-2 text-base font-semibold"},Ga={key:1,class:"mt-2"},Wa={class:"flex justify-end mt-4"},Ja={__name:"CannedResponseSelectorModal",props:Z({doctype:{type:String,default:""}},{modelValue:{},modelModifiers:{}}),emits:Z(["apply"],["update:modelValue"]),setup(t,{emit:n}){const c=t,a=ne(t,"modelValue"),s=I(""),m=n,r=I(""),u=Ue({type:"list",doctype:"HD Canned Response",cache:["cannedResponses",c.doctype],fields:["title","message","modified"],orderBy:"modified desc",pageLength:99999});ae(()=>{u.data==null&&u.fetch()});const g=T(()=>{var d;return((d=u.data)==null?void 0:d.filter(v=>v.title.toLowerCase().includes(r.value.toLowerCase())))??[]});return re(a,d=>d&&ve(()=>{var v,i;return(i=(v=s.value)==null?void 0:v.el)==null?void 0:i.focus()})),(d,v)=>{const i=A("FeatherIcon"),w=A("TextInput"),B=A("Button"),$=A("Dialog");return o(),V($,{modelValue:a.value,"onUpdate:modelValue":v[2]||(v[2]=p=>a.value=p),options:{title:"Canned Responses",size:"4xl"}},{"body-content":h(()=>[x(w,{ref_key:"searchInput",ref:s,modelValue:r.value,"onUpdate:modelValue":v[0]||(v[0]=p=>r.value=p),type:"text",placeholder:"Site Down"},{prefix:h(()=>[x(i,{name:"search",class:"h-4 w-4 text-gray-500"})]),_:1},8,["modelValue"]),g.value.length?(o(),C("div",Ha,[(o(!0),C(q,null,K(g.value,p=>(o(),C("div",{key:p.name,class:"flex h-56 cursor-pointer flex-col gap-2 rounded-lg border p-3 hover:bg-gray-100",onClick:b=>m("apply",p)},[f("div",Za,L(p.title),1),p.message?(o(),V(e(Fe),{key:0,content:p.message,editable:!1,"editor-class":"!prose-sm max-w-none !text-sm text-gray-600 focus:outline-none",class:"flex-1 overflow-hidden"},null,8,["content"])):j("",!0)],8,Ka))),128))])):(o(),C("div",Ga,[...v[3]||(v[3]=[f("div",{class:"flex h-56 flex-col items-center justify-center"},[f("div",{class:"text-lg text-gray-500"},L("No templates found"))],-1)])])),f("div",Wa,[x(B,{label:"New Canned Response",onClick:v[1]||(v[1]=()=>{d.$router.push("/canned-responses#new"),e(u).data=null})})])]),_:1},8,["modelValue"])}}},Ya={class:"flex items-center justify-start gap-5 border-b p-5"},Qa={class:"flex items-center justify-between flex-1"},Xa={class:"w-[242px] truncate text-2xl font-medium"},en={class:"flex gap-1.5"},Dn=P({__name:"TicketAgentContact",props:{contact:{type:Object,required:!0}},emits:["email:open"],setup(t,{emit:n}){const c=t,a=n;function s(){a("email:open",c.contact.email_id)}return(m,r)=>{const u=A("Button");return o(),C("div",Ya,[x(e(Ze),{size:"3xl",image:t.contact.image,label:t.contact.name},null,8,["image","label"]),f("div",Qa,[x(e(he),{text:t.contact.name},{default:h(()=>[f("div",Xa,L(t.contact.name),1)]),_:1},8,["text"]),f("div",en,[x(e(he),{text:t.contact.email_id},{default:h(()=>[x(u,{class:"h-7 w-7"},{icon:h(()=>[x(e(we),{class:"h-4 w-4",onClick:r[0]||(r[0]=g=>s())})]),_:1})]),_:1},8,["text"])])])])}}}),tn={class:"md:mx-10 md:my-4 flex items-center justify-between text-lg font-medium mx-6 mb-4 !mt-8"},ln={class:"flex h-8 items-center text-xl font-semibold text-gray-800"},an=P({__name:"ActivityHeader",props:{title:{type:String,required:!0}},setup(t){const n=ce("communicationArea"),c=T(()=>[{icon:W(we,{class:"h-4 w-4"}),label:"Email",onClick:()=>n.value.toggleEmailBox()},{icon:W(Be,{class:"h-4 w-4"}),label:"Comment",onClick:()=>n.value.toggleCommentBox()}]);return(a,s)=>{const m=A("FeatherIcon"),r=A("Button");return o(),C("div",tn,[f("div",ln,L(t.title),1),t.title=="Emails"?(o(),V(r,{key:0,variant:"solid",onClick:s[0]||(s[0]=u=>e(n).toggleEmailBox())},{prefix:h(()=>[x(m,{name:"plus",class:"h-4 w-4"})]),default:h(()=>[s[3]||(s[3]=f("span",null,L("New Email"),-1))]),_:1})):t.title=="Comments"?(o(),V(r,{key:1,variant:"solid",onClick:s[1]||(s[1]=u=>e(n).toggleCommentBox())},{prefix:h(()=>[x(m,{name:"plus",class:"h-4 w-4"})]),default:h(()=>[s[4]||(s[4]=f("span",null,L("New Comment"),-1))]),_:1})):(o(),V(e(Ge),{key:2,options:c.value,onClick:s[2]||(s[2]=Y(()=>{},["stop"]))},{default:h(({open:u})=>[x(r,{variant:"solid",class:"flex items-center gap-1"},{prefix:h(()=>[x(m,{name:"plus",class:"h-4 w-4"})]),suffix:h(()=>[x(m,{name:u?"chevron-up":"chevron-down",class:"h-4 w-4"},null,8,["name"])]),default:h(()=>[s[5]||(s[5]=f("span",null,L("New"),-1))]),_:2},1024)]),_:1},8,["options"]))])}}}),nn={key:0,class:"activities flex-1 h-full mt-1"},sn={class:"w-full px-6 md:px-10 grid grid-cols-[30px_minmax(auto,_1fr)] gap-2 sm:gap-4"},on={key:1,class:"h-full flex flex-col items-center justify-center gap-3 text-xl font-medium text-gray-500"},On=P({__name:"TicketAgentActivities",props:{activities:{type:Array,required:!0},title:{type:String,required:!0},ticketStatus:{type:String,default:""}},emits:["email:reply","update"],setup(t,{expose:n,emit:c}){const a=t,s=c,{getUser:m}=He(),r=ce("communicationArea"),u=T(()=>{let v="No Activities";if(a.title=="Emails")v="No Email Communications";else if(a.title=="Comments")return v="No Comments",v}),g=T(()=>{let v=rl;return a.title=="Emails"?v=we:a.title=="Comments"&&(v=Be),W(v,{class:"text-gray-500"})});function d(){setTimeout(()=>{let v,i=document.getElementsByClassName("activity");v=i[i.length-1],v&&!Ot(v).value&&(v.scrollIntoView(),v.focus())},500)}return n({scrollToLatestActivity:d}),ae(()=>{d()}),re(()=>a.title,()=>{d()}),(v,i)=>{const w=an,B=A("Button");return o(),C(q,null,[x(w,{title:t.title},null,8,["title"]),x(e(Zt),{class:"flex flex-col flex-1 overflow-y-scroll"},{default:h(()=>[t.activities.length?(o(),C("div",nn,[(o(!0),C(q,null,K(t.activities,($,p)=>{var b,k;return o(),C("div",{key:$.key,class:"activity"},[f("div",sn,[f("div",{class:H(["relative flex justify-center after:absolute after:left-[50%] after:top-2 after:-z-10 after:border-l after:border-gray-200",[p!=t.activities.length-1?"after:h-full":"after:h-4"]])},[f("div",{class:H(["z-10 flex h-7 w-7 items-center justify-center rounded-full bg-white",[$.type==="email"&&"mt-2"]])},[$.type==="email"?(o(),V(e(Ze),{key:0,size:"lg",label:(b=$.sender)==null?void 0:b.full_name,image:e(m)((k=$.sender)==null?void 0:k.name).user_image,class:"bg-white absolute left-[1px]"},null,8,["label","image"])):$.type==="comment"?(o(),V(e(Be),{key:1,class:"text-gray-600 absolute left-[7.5px]"})):(o(),V(e(gl),{key:2,class:"text-gray-600 absolute left-[7.5px]"}))],2)],2),f("div",{class:H(["mb-4 flex flex-1",[p==t.activities.length-1&&"mb-5"]])},[$.type==="email"?(o(),V(e(Ca),{key:0,activity:$,"show-split-option":!$.isFirstEmail&&t.ticketStatus!=="Closed",class:"py-2 px-3",onReply:i[0]||(i[0]=l=>s("email:reply",l))},null,8,["activity","show-split-option"])):$.type==="comment"?(o(),V(e(Ea),{key:1,activity:$,onUpdate:i[1]||(i[1]=()=>s("update"))},null,8,["activity"])):(o(),V(e(Na),{key:2,activity:$},null,8,["activity"]))],2)])])}),128))])):(o(),C("div",on,[(o(),V(qe(g.value),{class:"h-10 w-10"})),f("span",null,L(u.value),1),t.title=="Emails"?(o(),V(B,{key:0,label:"New Email",onClick:i[2]||(i[2]=$=>e(r).toggleEmailBox())})):t.title=="Comments"?(o(),V(B,{key:1,label:"New Comment",onClick:i[3]||(i[3]=$=>e(r).toggleCommentBox())})):j("",!0)]))]),_:1})],64)}}}),rn={class:"flex flex-col gap-3 border-b px-6 py-3"},un={class:"w-[126px] text-sm text-gray-600"},dn={class:"flex items-center justify-between"},cn={key:0},Pn=P({__name:"TicketAgentDetails",props:{ticket:{type:Object,required:!0}},setup(t){const n=t;let c=null,a=null;const s=I(0),m=I(0),r=T(()=>{let i=null;if(!n.ticket.first_responded_on&&U().isBefore(U(n.ticket.response_by))){let w=ie(U(n.ticket.response_by).diff(U(),"s"));c&&(clearInterval(c),c=null),d(w),i={label:`Due in ${ie(s.value)}`,color:"orange"}}else U(n.ticket.first_responded_on).isBefore(U(n.ticket.response_by))?i={label:`Fulfilled in ${ie(U(n.ticket.first_responded_on).diff(U(n.ticket.creation),"s"))}`,color:"green"}:i={label:"Failed",color:"red"};return i}),u=T(()=>{let i=null;if(a&&clearInterval(a),n.ticket.status==="Replied"&&n.ticket.on_hold_since&&U(n.ticket.resolution_by).isAfter(U(n.ticket.on_hold_since))){let w=U(n.ticket.resolution_by).diff(U(),"s");i={label:`${ie(w)} left (On Hold)`,color:"blue"}}else if(!n.ticket.resolution_date&&U().isBefore(n.ticket.resolution_by)){let w=ie(U(n.ticket.resolution_by).diff(U(),"s"));v(w),i={label:`Due in ${ie(m.value)}`,color:"orange"}}else U(n.ticket.resolution_date).isBefore(n.ticket.resolution_by)?i={label:`Fulfilled in ${ie(U(n.ticket.resolution_date).diff(U(n.ticket.creation),"s"))}`,color:"green"}:i={label:"Failed",color:"red"};return i}),g=T(()=>[{label:"First Response",tooltipValue:ue(n.ticket.first_responded_on||n.ticket.response_by,de),badgeText:r.value.label,badgeColor:r.value.color},{label:"Resolution",tooltipValue:ue(n.ticket.resolution_date||n.ticket.resolution_by,de),badgeText:u.value.label,badgeColor:u.value.color},{label:"Source",value:n.ticket.via_customer_portal?"Portal":"Mail"}]);re(()=>n.ticket.status,i=>{i!=="Open"&&(c&&(clearInterval(c),c=null),a&&(clearInterval(a),a=null))},{deep:!0,immediate:!0});function d(i){i&&n.ticket.status==="Open"&&(s.value=Xe(i),c=setInterval(()=>{if(s.value<=0){clearInterval(c);return}s.value--},1e3))}function v(i){i&&n.ticket.status==="Open"&&(m.value=Xe(i),a=setInterval(()=>{if(m.value<=0){clearInterval(a);return}m.value--},1e3))}return Pe(()=>{c&&clearInterval(c),a&&clearInterval(a),c=null,a=null}),(i,w)=>(o(),C("div",rn,[(o(!0),C(q,null,K(g.value,B=>(o(),C("div",{key:B.label,class:"flex items-center text-base leading-5"},[x(e(he),{text:B.label},{default:h(()=>[f("div",un,L(B.label),1)]),_:2},1032,["text"]),f("div",dn,[B.value?(o(),C("div",cn,L(B.value),1)):j("",!0),x(e(he),{text:B.tooltipValue},{default:h(()=>[B.badgeText?(o(),V(e(Pt),{key:0,class:"-ml-1",label:B.badgeText,variant:"subtle",theme:B.badgeColor},null,8,["label","theme"])):j("",!0)]),_:2},1032,["text"])])]))),128))]))}}),mn={class:"flex gap-2 px-6 pb-1 leading-5 first:mt-3 items-baseline"},fn={class:"w-[106px] shrink-0 truncate text-sm text-gray-600"},pn={key:0,class:"text-red-500"},vn={class:"-m-0.5 min-h-[28px] flex-1 items-center overflow-hidden p-0.5 text-base"},xn=P({__name:"UniInput2",props:{field:{},value:{type:[String,Number,Boolean]}},emits:["change"],setup(t,{emit:n}){const c=t,a=n,s=["Long Text","Small Text","Text","Text Editor","Data"],m=T(()=>c.field.url_method?W(Ve,{options:r.data}):c.field.fieldtype==="Link"&&c.field.options?W(Ht,{doctype:c.field.options,hideMe:!0}):c.field.fieldtype==="Select"?W(Ve,{options:c.field.options.split(`
`).map(d=>({label:d,value:d}))}):c.field.fieldtype==="Check"?W(Ve,{options:[{label:"Yes",value:1},{label:"No",value:0}]}):s.includes(c.field.fieldtype)?W(et,{type:"textarea"}):W(et)),r=se({url:c.field.url_method,auto:!!c.field.url_method,transform:d=>d!=null&&d.length?(d==null?void 0:d.map(v=>({label:v,value:v})))||[]:[]}),u=T(()=>c.field.fieldtype==="Check"?c.value?"Yes":"No":c.value);function g(d,v){a("change",{fieldname:d,value:v})}return(d,v)=>(o(),C("div",mn,[x(e(he),{text:d.field.label},{default:h(()=>[f("div",fn,[xe(L(d.field.label)+" ",1),d.field.required?(o(),C("span",pn," * ")):j("",!0)])]),_:1},8,["text"]),f("div",vn,[(o(),V(qe(m.value),ke({key:d.field.fieldname,class:"form-control",placeholder:`Add ${d.field.label}`,"model-value":u.value,autocomplete:"off"},qt(s.includes(d.field.fieldtype)?{blur:i=>{g(d.field.fieldname,i.target.value)}}:{"update:model-value":i=>{var w;g(d.field.fieldname,(i==null?void 0:i.value)||((w=i==null?void 0:i.target)==null?void 0:w.value)||i)}})),null,16,["placeholder","model-value"]))])]))}});const gn=oe(xn,[["__scopeId","data-v-1efaa69a"]]),bn={class:"flex flex-1 flex-col overflow-hidden overflow-y-auto border-b"},yn=P({__name:"TicketAgentFields",props:{ticket:{type:Object,required:!0}},emits:["update"],setup(t,{emit:n}){const c=n,a=t,s=T(()=>a.ticket.fields);function m(r,u,g=null){if(r==="subject"&&u===""){pe.error("Subject is required"),g.target.value=a.ticket.subject;return}c("update",{field:r,value:u})}return(r,u)=>(o(),C("div",bn,[(o(!0),C(q,null,K(s.value,g=>(o(),V(gn,{key:g.fieldname,field:g,value:t.ticket[g.fieldname],onChange:u[0]||(u[0]=d=>m(d.fieldname,d.value))},null,8,["field","value"]))),128))]))}});const qn=oe(yn,[["__scopeId","data-v-a9303fca"]]);export{rl as A,Be as C,qn as T,ll as _,al as a,Pn as b,On as c,Mn as d,jn as e,Rn as f,Dn as g};
//# sourceMappingURL=TicketAgentFields-2425efde.js.map
