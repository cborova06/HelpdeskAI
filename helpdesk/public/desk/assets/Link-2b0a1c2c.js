import{A as P,aS as X,aT as Y,c as C,a3 as F,ao as Z,e as i,f as E,w as f,g as v,h as r,P as ee,C as _,D as O,E as N,l as g,x as M,k as c,t as V,R,aA as I,az as te,aB as ae,F as G,G as H,y as j,aC as se,a1 as J,s as le,aE as W,aD as re,ax as K,W as oe,r as Q,aJ as ue}from"./index-62a62e6e.js";const ne={class:"w-full"},ie=["onClick"],de={class:"flex items-center"},ce={key:0,class:"overflow-hidden text-ellipsis whitespace-nowrap text-base leading-5"},fe={key:1,class:"text-base leading-5 text-gray-500"},pe={class:"mt-1 rounded-lg bg-white py-1 text-base shadow-2xl"},me={class:"relative px-1.5 pt-0.5"},ge={key:0,class:"px-2.5 py-1.5 text-sm font-medium text-gray-500"},ye={key:0,class:"mt-1.5 rounded-md px-2.5 py-1.5 text-base text-gray-600"},he={key:0,class:"border-t p-1.5 pb-0.5"},ve={__name:"Autocomplete",props:{modelValue:{type:[String,Object],default:""},options:{type:Array,default:()=>[]},size:{type:String,default:"md"},variant:{type:String,default:"subtle"},placeholder:{type:String,default:""},disabled:{type:Boolean,default:!1},filterable:{type:Boolean,default:!0}},emits:["update:modelValue","update:query","change"],setup($,{expose:A,emit:s}){const o=$,d=s,p=P(""),b=P(!1),B=P(null),w=X(),y=Y(),z=C(()=>"value"in w),k=C({get(){return z.value?w.value:o.modelValue},set(e){p.value="",e&&(b.value=!1),d(z.value?"change":"update:modelValue",e)}});function T(){b.value=!1}const t=C(()=>{var a;return!o.options||o.options.length==0?[]:((a=o.options[0])!=null&&a.group?o.options:[{group:"",items:o.options}]).map((u,n)=>({key:n,group:u.group,hideLabel:u.hideLabel||!1,items:o.filterable?h(u.items):u.items})).filter(u=>u.items.length>0)});function h(e){return p.value?e.filter(a=>[a.label,a.value].some(n=>(n||"").toString().toLowerCase().includes(p.value.toLowerCase()))):e}function l(e){if(typeof e=="string"){let u=t.value.flatMap(n=>n.items).find(n=>n.value===e);return(u==null?void 0:u.label)||e}return e==null?void 0:e.label}F(p,e=>{d("update:query",e)}),F(b,e=>{e&&Z(()=>{B.value.el.focus()})});const S=C(()=>o.disabled?"text-gray-600":"text-gray-800"),m=C(()=>{let e={sm:"text-base rounded h-7",md:"text-base rounded h-8",lg:"text-lg rounded-md h-10",xl:"text-xl rounded-md h-10"}[o.size],a={sm:"py-1.5 px-2",md:"py-1.5 px-2.5",lg:"py-1.5 px-3",xl:"py-1.5 px-3"}[o.size],u=o.disabled?"disabled":o.variant,n={subtle:"border border-gray-100 bg-gray-100 placeholder-gray-500 hover:border-gray-200 hover:bg-gray-200 focus:bg-white focus:border-gray-500 focus:shadow-sm focus:ring-0 focus-visible:ring-2 focus-visible:ring-gray-400",outline:"border border-gray-300 bg-white placeholder-gray-500 hover:border-gray-400 hover:shadow-sm focus:bg-white focus:border-gray-500 focus:shadow-sm focus:ring-0 focus-visible:ring-2 focus-visible:ring-gray-400",disabled:["border bg-gray-50 placeholder-gray-400",o.variant==="outline"?"border-gray-300":"border-transparent"]}[u];return[e,a,n,S.value,"transition-colors w-full"]});return A({query:p}),(e,a)=>(i(),E(r(re),{modelValue:k.value,"onUpdate:modelValue":a[3]||(a[3]=u=>k.value=u),nullable:""},{default:f(({open:u})=>[v(r(ee),{class:"w-full",show:b.value,"onUpdate:show":a[2]||(a[2]=n=>b.value=n)},{target:f(({open:n,togglePopover:L})=>[_(e.$slots,"target",O(N({open:n,togglePopover:L,isOpen:b.value,selectedValue:k.value,displayValue:l})),()=>[g("div",ne,[g("button",{class:M(["flex w-full items-center justify-between focus:outline-none",m.value]),onClick:()=>!$.disabled&&L()},[g("div",de,[_(e.$slots,"prefix"),k.value?(i(),c("span",ce,V(l(k.value)),1)):(i(),c("span",fe,V($.placeholder||""),1))]),v(r(R),{name:"chevron-down",class:"h-4 w-4 text-gray-600","aria-hidden":"true"})],10,ie)])])]),body:f(({isOpen:n})=>{var L;return[I(g("div",null,[g("div",pe,[g("div",me,[v(r(te),{ref_key:"search",ref:B,class:"form-input w-full",type:"text",onChange:a[0]||(a[0]=x=>{p.value=x.target.value}),value:p.value,autocomplete:"off",placeholder:"Search"},null,8,["value"]),g("button",{class:"absolute right-1.5 inline-flex h-7 w-7 items-center justify-center",onClick:a[1]||(a[1]=x=>k.value=null)},[v(r(R),{name:"x",class:"w-4"})])]),v(r(ae),{class:"my-1 max-h-[12rem] overflow-y-auto px-1.5",static:""},{default:f(()=>[(i(!0),c(G,null,H(t.value,x=>I((i(),c("div",{class:"mt-1.5",key:x.key},[x.group&&!x.hideLabel?(i(),c("div",ge,V(x.group),1)):j("",!0),(i(!0),c(G,null,H(x.items,D=>(i(),E(r(se),{as:"template",key:D.value,value:D},{default:f(({active:q,selected:U})=>[g("li",{class:M(["flex items-center rounded px-2.5 py-1.5 text-base",{"bg-gray-100":q}])},[_(e.$slots,"item-prefix",J({ref_for:!0},{active:q,selected:U,option:D})),_(e.$slots,"item-label",J({ref_for:!0},{active:q,selected:U,option:D}),()=>[le(V(D.label),1)])],2)]),_:2},1032,["value"]))),128))])),[[W,x.items.length>0]])),128)),t.value.length==0?(i(),c("li",ye," No results found ")):j("",!0)]),_:3}),r(y).footer?(i(),c("div",he,[_(e.$slots,"footer",O(N({value:(L=B.value)==null?void 0:L.el._value,close:T})))])):j("",!0)])],512),[[W,n]])]}),_:3},8,["show"])]),_:3},8,["modelValue"]))}},be={class:"space-y-1.5"},xe={key:0,class:"flex flex-col gap-1"},_e={class:"flex-1 font-semibold truncate text-ink-gray-7"},we={class:"flex-1 text-sm truncate text-ink-gray-5"},ke={key:1,class:"flex-1 truncate text-ink-gray-7"},Ce={key:0},$e={__name:"Link",props:{doctype:{type:String,required:!0},filters:{type:Object,default:null},modelValue:{type:String,default:""},hideMe:{type:Boolean,default:!1},pageLength:{type:Number,default:10},hideClearButton:{type:Boolean,default:!1},showDescription:{type:Boolean,default:!1}},emits:["update:modelValue","change"],setup($,{emit:A}){const s=$,o=A,d=X(),p=C(()=>"value"in d),b=C({get:()=>p.value?d.value:s.modelValue,set:t=>(t==null?void 0:t.value)&&o(p.value?"change":"update:modelValue",t==null?void 0:t.value)}),B=P(null),w=P("");K(()=>{var t;return(t=B.value)==null?void 0:t.query},t=>{t=t||"",w.value!==t&&(w.value=t,z(t))},{debounce:300,immediate:!0}),K(()=>s.doctype,()=>z(""),{debounce:300,immediate:!0}),F(()=>s==null?void 0:s.filters,t=>{y.update({params:{txt:w.value,doctype:s.doctype,filters:t,page_length:s.pageLength}}),y.reload()},{deep:!0});const y=oe({url:"frappe.desk.search.search_link",cache:[s.doctype,w.value,s.hideMe],method:"POST",params:{txt:w.value,doctype:s.doctype,filters:s.filters,page_length:s.pageLength},transform:t=>{let h=t.map(l=>({value:l.value,label:(l==null?void 0:l.label)||l.value,description:l==null?void 0:l.description}));return!s.hideMe&&(s.doctype=="User"||s.doctype=="HD Agent")&&h.unshift({label:"@me",value:"@me"}),h}});function z(t){var h,l,S;(h=y.data)!=null&&h.length&&t===((l=y.params)==null?void 0:l.txt)&&s.doctype===((S=y.params)==null?void 0:S.doctype)||(y.update({params:{txt:t,doctype:s.doctype,filters:s.filters,page_length:s.pageLength}}),y.reload())}function k(t){o(p.value?"change":"update:modelValue",""),t()}const T=C(()=>[{sm:"text-xs",md:"text-base"}[d.size||"sm"],"text-gray-600"]);return(t,h)=>{const l=Q("FeatherIcon"),S=Q("Button");return i(),c("div",be,[r(d).label?(i(),c("label",{key:0,class:M(["block",T.value])},V(r(d).label),3)):j("",!0),v(ve,{ref_key:"autocomplete",ref:B,options:r(y).data,modelValue:b.value,"onUpdate:modelValue":h[0]||(h[0]=m=>b.value=m),size:r(d).size||"sm",variant:r(d).variant,placeholder:r(d).placeholder,filterable:!1,disabled:r(d).disabled},ue({target:f(({open:m,togglePopover:e})=>[_(t.$slots,"target",O(N({open:m,togglePopover:e})))]),prefix:f(()=>[_(t.$slots,"prefix")]),"item-prefix":f(({active:m,selected:e,option:a})=>[_(t.$slots,"item-prefix",O(N({active:m,selected:e,option:a})))]),"item-label":f(({active:m,selected:e,option:a})=>[_(t.$slots,"item-label",O(N({active:m,selected:e,option:a})),()=>[a.description&&$.showDescription?(i(),c("div",xe,[g("div",_e,V(a.label),1),g("div",we,V(a.description),1)])):(i(),c("div",ke,V(a.label),1))])]),_:2},[$.hideClearButton?void 0:{name:"footer",fn:f(({value:m,close:e})=>[r(d).onCreate?(i(),c("div",Ce,[v(S,{variant:"ghost",class:"w-full !justify-start",label:"Create New",onClick:a=>r(d).onCreate(m,e)},{prefix:f(()=>[v(l,{name:"plus",class:"h-4"})]),_:2},1032,["onClick"])])):j("",!0),g("div",null,[v(S,{variant:"ghost",class:"w-full !justify-start",label:"Clear",onClick:()=>k(e)},{prefix:f(()=>[v(l,{name:"x",class:"h-4"})]),_:2},1032,["onClick"])])]),key:"0"}]),1032,["options","modelValue","size","variant","placeholder","disabled"])])}}};export{$e as _,ve as a};
//# sourceMappingURL=Link-2b0a1c2c.js.map
